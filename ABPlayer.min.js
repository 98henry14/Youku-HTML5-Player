function isMobile(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}Array.from=Array.from||function(e){return[].slice.call(e)};var ABP={version:"0.8.0"};ABP.Strings={statsPlayer:"播放器尺寸：",statsVideo:"视频分辨率：",statsBuffer:"可用缓冲：",statsBufferClip:"缓冲片段：",statsMozParse:"已解析帧：",statsMozDecode:"已解码帧：",statsMozPaint:"已绘制帧：",statsWebkitDecode:"已解码帧：",statsPresent:"已显示帧：",statsDrop:"已丢弃帧：",statsMimetype:"文件格式：",statsVideoBitrate:"本段视频码率：",statsAudioBitrate:"本段音频码率：",statsCurrentBitrate:"本段码率：",statsRealtimeBitrate:"实时码率：",overallBitrate:"总体码率：",statsDownloadSpeed:"下载速度：",sendSmall:"小字号",sendMid:"中字号",sendSize:"弹幕字号",sendMode:"弹幕模式",sendTop:"顶端渐隐",sendScroll:"滚动字幕",sendBottom:"底端渐隐",send:"发送",sendStyle:"弹幕样式",sendColor:"弹幕颜色",commentSpeed:"弹幕速度",commentScale:"弹幕比例",commentOpacity:"弹幕不透明度",commentBlock:"弹幕屏蔽设定",playSpeed:"播放速度",playSpeedReset:"还原正常速度",displayScaleD:"默认",displayScaleF:"全屏",shieldTypeText:"文字",shieldTypeUser:"用户",shieldTypeColor:"颜色",shieldTypeSetting:"设置",shieldAdd:"添加屏蔽……",shieldUseRegex:"启用正则",shieldBlockTop:"屏蔽顶端弹幕",shieldBlockBottom:"屏蔽底端弹幕",shieldBlockVisitor:"屏蔽游客弹幕",shieldRepeat:"去除刷屏弹幕",viewers:" 观众",comments:" 弹幕",commentTime:"时间",commentContent:"评论",commentDate:"发送日期",showStats:"显示统计信息",loadingMeta:"正在加载视频信息",switching:"正在切换",fetchURL:"正在获取视频地址",buffering:"正在缓冲",play:"播放",pause:"暂停",mute:"静音",unmute:"取消静音",muteNotSupported:"不支持静音",fullScreen:"浏览器全屏",exitFullScreen:"退出全屏",webFull:"网页全屏",exitWebFull:"退出网页全屏",wideScreen:"宽屏模式",exitWideScreen:"退出宽屏",sendTooltip:"毁灭地喷射白光!da!",showComment:"显示弹幕",hideComment:"隐藏弹幕",loopOn:"洗脑循环 on",loopOff:"洗脑循环 off",usingCanvas:"正在使用Canvas",usingCSS:"正在使用CSS",useCSS:"使用CSS绘制弹幕",autoOpacityOn:"关闭自动不透明度",autoOpacityOff:"开启自动不透明度",copyComment:"复制弹幕",findComment:"定位弹幕",blockContent:"屏蔽内容“",blockUser:"屏蔽发送者",blockColor:"屏蔽颜色",blockColorWhite:"不能屏蔽白色",copyFail:"复制失败，浏览器不支持",blockUserEmpty:"没有屏蔽用户",blockColorEmpty:"没有屏蔽颜色",repeatPcs:"条",repeatUnlimited:"不限制",dragControlLowInc:"低速快进",dragControlLowDec:"低速快退",dragControlMedInc:"中速快进",dragControlMedDec:"中速快退",dragControlHighInc:"高速快进",dragControlHighDec:"高速快退",dragControlCancel:"取消跳转"},function(){"use strict";if(ABP){var e="addEventListener",t="HTML5 Player ver.170426 based on ABPlayer-bilibili-ver",i=[0,0],a=function(e){var t=i;return i=[e.clientX,e.clientY],t[0]==i[0]&&t[1]==i[1]},n=function(e){return document.getElementById(e)},o=function(e,t,i,a){var n=null;if("text"===e)return document.createTextNode(t);n=document.createElement(e);for(var o in t)if("style"!==o&&"className"!==o)n.setAttribute(o,t[o]);else if("className"===o)n.className=t[o];else for(var l in t.style)n.style[l]=t.style[l];if(i)for(var s=0;s<i.length;s++)null!=i[s]&&n.appendChild(i[s]);return a&&"function"==typeof a&&a(n),n},l=function(e,t){for(;e;e=e.parentNode)if(p(e.parentNode,t))return e};HTMLElement.prototype.tooltip=function(e){this.tooltipData=e,this.dispatchEvent(new Event("updatetooltip"))},"undefined"==typeof HTMLElement.prototype.requestFullScreen&&(HTMLElement.prototype.requestFullScreen=function(){this.webkitRequestFullscreen?this.webkitRequestFullscreen():this.mozRequestFullScreen?this.mozRequestFullScreen():this.msRequestFullscreen&&this.msRequestFullscreen()}),"undefined"==typeof document.isFullScreen&&(document.isFullScreen=function(){return document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenEnabled}),"undefined"==typeof document.exitFullscreen&&(document.exitFullscreen=function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():window.msExitFullscreen&&msExitFullscreen()});var s=function(e,t){for(var i="",a=1;a<=t-(e+"").length;a++)i+="0";return i+e},r=function(e,t){if(0==e)return lang.oneDay;var i,a,n,o,l,s,r=new Date(1e3*parseInt(e));return i=String(r.getFullYear()),a=String(r.getMonth()+1),1==a.length&&(a="0"+a),n=String(r.getDate()),1==n.length&&(n="0"+n),o=String(r.getHours()),1==o.length&&(o="0"+o),l=String(r.getMinutes()),1==l.length&&(l="0"+l),s=String(r.getSeconds()),1==s.length&&(s="0"+s),String(t?a+"-"+n+" "+o+":"+l:i+"-"+a+"-"+n+" "+o+":"+l+":"+s)},d=function(e){return isNaN(e)?"00:00":s(parseInt(e/60),2)+":"+s(parseInt(e%60),2)},c=function(e){for(var t=e.split(":"),i=0,a=0;a<t.length;a++){i*=60;var n=parseInt(t[a]);if(isNaN(n)||0>n)return!1;i+=n}return i},m=function(t,i,a){if(t){t[e]("mousemove",function(e){var s,r=n("ABP-Tooltip"),d=t.clientWidth,c=t.clientHeight,m=t.getBoundingClientRect(),u=l(t,"ABP-Unit").getBoundingClientRect(),p=m.top-u.top,v=i?e.clientX-u.left:m.left-u.left,f=v;null==r&&(r=o("div",{id:"ABP-Tooltip"},[o("text",t.tooltipData)]),r.by=t,l(t,"ABP-Unit").appendChild(r),r.style.top=p+c+2+"px",r.style.left=v+d/2-r.clientWidth/2+"px",f+=d/2-r.clientWidth/2),i&&(r.style.left=v-r.clientWidth/2+"px",f-=d/2),s=r.getBoundingClientRect(),s.left<u.left?r.style.left="0px":s.right>u.right&&(r.style.left=u.width-s.width+"px"),a=a||-6,a&&(r.style.top=p-r.clientHeight+2+a+"px")});var s=function(){var e=n("ABP-Tooltip");e&&e.parentNode&&e.remove()},r=null;t[e]("mouseout",s),t[e]("touchend",function(){null!=r&&(clearTimeout(r),r=null),r=setTimeout(function(){r=null,s()},2e3)}),t[e]("updatetooltip",function(e){var i=n("ABP-Tooltip");i&&i.by==e.target&&(i.innerHTML=t.tooltipData)})}},u=function(e,t){if(null!=e){var i=e.className.split(" ");""==i[0]&&(i=[]),i.indexOf(t)<0&&i.push(t),e.className=i.join(" ")}},p=function(e,t){if(null==e)return!1;var i=e.className.split(" ");return""==i[0]&&(i=[]),i.indexOf(t)>=0},v=function(e,t){if(null!=e){var i=e.className.split(" ");""==i[0]&&(i=[]),i.indexOf(t)>=0&&i.splice(i.indexOf(t),1),e.className=i.join(" ")}},f=function(e,t){var i={};for(var a in t)i[a]=e&&"undefined"!=typeof e[a]?e[a]:t[a];return i};ABP.create=function(i,a){var l=i;if(a||(a={}),ABP.playerConfig=a.config?a.config:{},a=f(a,{replaceMode:!0,width:512,height:384,src:""}),"string"==typeof i&&(l=n(i)),p(l,"ABP-Unit"))s=l;else{var s=o("div",{className:"ABP-Unit",style:{width:a.width.toString().indexOf("%")>=0?a.width:a.width+"px",height:a.height.toString().indexOf("%")>=0?a.height:a.height+"px"}});l.appendChild(s)}s.children.length>0&&a.replaceMode&&(s.innerHTML="");var r=[],d=[];if("string"==typeof a.src)a.src=o("video",{autobuffer:"true",dataSetup:"{}"},[o("source",{src:a.src})]),r.push(a.src);else if(a.src.hasOwnProperty("playlist"))for(var c=a.src,m=c.playlist,u=0;u<m.length;u++){if(m[u].hasOwnProperty("sources")){var v=[];for(var g in m[u].sources)v.push(o("source",{src:m[u][g],type:g}));r.push(o("video",{autobuffer:"true",dataSetup:"{}"},v))}else m[u].hasOwnProperty("video")&&r.push(m[u].video);d.push(m[u].comments)}else r.push(a.src);s.appendChild(o("div",{className:"ABP-Player"},[o("div",{className:"ABP-Video",tabindex:"10"},[o("div",{id:"info-box",style:{opacity:1}},[o("div",{className:"text-wrapper"},[o("div",{},[o("text",ABP.Strings.loadingMeta)])]),o("div",{id:"dots"})]),o("div",{className:"ABP-Container"}),r[0],o("div",{className:"Player-Stats"},[o("div",{id:"player-dimension"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsPlayer)]),o("span")]),o("div",{id:"video-dimension"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsVideo)]),o("span")]),o("div",{id:"mimeType"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsMimetype)]),o("span")]),o("div",{id:"buffer-health"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsBuffer)]),o("span",{className:"stats-column",id:"buffer-health-column"}),o("span")]),o("div",{style:{position:"relative"}},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsBufferClip)]),o("span",{id:"buffer-clips"},[o("span"),o("span",{},[o("div",{style:{width:"1px",height:"400%",top:"-150%",position:"absolute",background:"#FFF",left:0}})])]),o("pre",{style:{position:"absolute",margin:0,left:"250px",width:"90px",fontFamily:"inherit"}})]),o("br",{className:"flvjs"}),o("div",{className:"flvjs"},[o("span",{className:"stats_name"},[o("text","fps：")]),o("span")]),o("div",{className:"flvjs",title:"1 kbps = 1000 bps"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsVideoBitrate)]),o("span")]),o("div",{className:"flvjs",title:"1 kbps = 1000 bps"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsAudioBitrate)]),o("span")]),o("div",{className:"flvjs",title:"1 kbps = 1000 bps"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsCurrentBitrate)]),o("span")]),o("div",{title:"1 kbps = 1000 bps"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.overallBitrate)]),o("span",{id:"overall-bitrate"})]),o("div",{className:"flvjs",title:"1 kbps = 1000 bps"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsRealtimeBitrate)]),o("span",{className:"stats-column",id:"realtime-bitrate-column",style:{verticalAlign:"top"}}),o("span")]),o("div",{className:"flvjs"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsDownloadSpeed)]),o("span",{className:"stats-column",id:"download-speed-column",style:{verticalAlign:"top"}}),o("span")]),o("br"),o("div",{className:"gecko"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsMozParse)]),o("span",{id:"mozParsedFrames"})]),o("div",{className:"gecko"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsMozDecode)]),o("span",{id:"mozDecodedFrames"})]),o("div",{className:"gecko"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsMozPaint)]),o("span",{id:"mozPaintedFrames"})]),o("div",{className:"webkit"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsWebkitDecode)]),o("span",{id:"webkitDecodedFrameCount"})]),o("div",{className:"webkit"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsDrop)]),o("span",{id:"webkitDroppedFrameCount"})]),o("div",{className:"videoQuality"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsPresent)]),o("span",{id:"totalVideoFrames"})]),o("div",{className:"videoQuality"},[o("span",{className:"stats_name"},[o("text",ABP.Strings.statsDrop)]),o("span",{id:"droppedVideoFrames"})]),o("br"),o("div",{style:{fontSize:"11px"}},[o("text",t)]),o("div",{style:{fontSize:"11px"}},[o("text","2017©esterTion")]),o("div",{id:"stats-close"},[o("text","×")])]),o("div",{className:"Drag-Control"},[o("div",{className:"Drag-Icon"}),o("div",{className:"Drag-Speed"},[o("text","")]),o("div",{className:"Drag-Time"},[o("text","00:00╱00:00")]),o("div",{className:"Drag-Time-Bar"},[o("div",{className:"fill"})])])]),o("div",{className:"ABP-Bottom"},[o("div",{className:"ABP-Bottom-Extend"}),o("div",{className:"BiliPlus-Scale-Menu"},[o("div",{className:"Video-Defination"}),o("div",{className:"Video-Scale"},[o("div",{changeTo:"default",className:"on"},[o("text",ABP.Strings.displayScaleD)]),o("div",{changeTo:"16_9"},[o("text","16:9")]),o("div",{changeTo:"4_3"},[o("text","4:3")]),o("div",{changeTo:"full"},[o("text",ABP.Strings.displayScaleF)])])]),o("div",{className:"ABP-Text"},[o("div",{className:"ABP-CommentStyle"},[o("div",{className:"button-group ABP-Comment-FontGroup"},[o("div",{className:"button ABP-Comment-Font icon-font-style"}),o("div",{className:"ABP-Comment-FontOption"},[o("p",{className:"style-title"},[o("text",ABP.Strings.sendSize)]),o("div",{className:"style-select",name:"commentFontSize"},[o("div",{className:"style-option",value:18},[o("text",ABP.Strings.sendSmall)]),o("div",{className:"style-option on",value:25},[o("text",ABP.Strings.sendMid)])]),o("p",{className:"style-title"},[o("text",ABP.Strings.sendMode)]),o("div",{className:"style-select",name:"commentMode"},[o("div",{className:"style-option",value:5},[o("text",ABP.Strings.sendTop)]),o("div",{className:"style-option on",value:1},[o("text",ABP.Strings.sendScroll)]),o("div",{className:"style-option",value:4},[o("text",ABP.Strings.sendBottom)])])])]),o("div",{className:"button-group ABP-Comment-ColorGroup"},[o("div",{className:"ABP-Comment-Color-Display"}),o("div",{className:"button ABP-Comment-Color icon-color-mode"}),o("div",{className:"ABP-Comment-ColorOption"},[o("div",{className:"ABP-Comment-ColorPicker"})])])]),o("form",{},[o("input",{className:"ABP-Comment-Input"})]),o("div",{className:"ABP-Comment-Send"},[o("text",ABP.Strings.send)])]),o("div",{className:"ABP-Control"},[o("div",{className:"button ABP-Play icon-play"}),o("div",{className:"progress-bar"},[o("div",{className:"bar"},[o("div",{className:"load"}),o("div",{className:"dark"})])]),o("div",{className:"time-label"},[o("text","00:00 / 00:00")]),o("div",{className:"button ABP-Volume icon-volume-high"}),o("div",{className:"volume-bar"},[o("div",{className:"bar"},[o("div",{className:"load"})])]),o("div",{className:"button-group ABP-CommentGroup"},[o("div",{className:"button ABP-CommentShow icon-comment on"}),o("div",{className:"ABP-CommentOption"},[o("p",{className:"label"},[o("text",ABP.Strings.useCSS),o("div",{className:"prop-checkbox"})]),o("p",{className:"label"},[o("text",ABP.Strings.commentSpeed)]),o("div",{className:"speed-bar"},[o("div",{className:"bar"},[o("div",{className:"load"})])]),o("p",{className:"label"},[o("text",ABP.Strings.commentScale)]),o("div",{className:"scale-bar"},[o("div",{className:"bar"},[o("div",{className:"load"})])]),o("p",{className:"label"},[o("text",ABP.Strings.commentOpacity)]),o("div",{className:"opacity-bar",style:{width:"calc(100% - 25px)"}},[o("div",{className:"bar"},[o("div",{className:"load"})])]),o("div",{className:"prop-checkbox",style:{top:"121px"}}),o("div",{className:"shield-enrty"},[o("text",ABP.Strings.commentBlock)])])]),o("div",{className:"button-group ABP-PlaySpeedGroup"},[o("div",{className:"button ABP-Loop icon-loop"}),o("div",{className:"ABP-PlaySpeedOption"},[o("p",{className:"label"},[o("text",ABP.Strings.playSpeed)]),o("div",{className:"playSpeed-bar"},[o("div",{className:"bar"},[o("div",{className:"load"})])]),o("div",{className:"play-speed-reset"},[o("text",ABP.Strings.playSpeedReset)])])]),o("div",{className:"button ABP-WideScreen icon-tv"}),o("div",{className:"button-group ABP-FullScreenGroup"},[o("div",{className:"button ABP-FullScreen icon-screen-full"}),o("div",{className:"button ABP-Web-FullScreen icon-screen"})])])])])),s.appendChild(o("div",{className:"shield hidden"},[o("div",{className:"shield_top"},[o("text",ABP.Strings.commentBlock),o("span",{className:"close"})]),o("div",{className:"shield_tabs"},[o("div",{className:"shield_tab on"},[o("div",{},[o("text",ABP.Strings.shieldTypeText)])]),o("div",{className:"shield_tab"},[o("div",{},[o("text",ABP.Strings.shieldTypeUser)])]),o("div",{className:"shield_tab"},[o("div",{},[o("text",ABP.Strings.shieldTypeColor)])]),o("div",{className:"shield_tab"},[o("div",{},[o("text",ABP.Strings.shieldTypeSetting)])])]),o("div",{className:"shield_tab_slash"}),o("div",{className:"shield_body"},[o("div",{className:"shield_body_wrapper"},[o("div",{className:"shield_tab_body"},[o("div",{id:"shield_text"}),o("div",{className:"shield_item"},[o("input",{className:"new",type:"text",placeholder:ABP.Strings.shieldAdd}),o("div",{className:"add"})])]),o("div",{className:"shield_tab_body"},[o("div",{id:"shield_user"})]),o("div",{className:"shield_tab_body"},[o("div",{id:"shield_color"})]),o("div",{className:"shield_tab_body"},[o("div",{className:"shield_toggle",id:"useReg"},[o("text",ABP.Strings.shieldUseRegex)]),o("div",{className:"shield_toggle",id:"blockTop"},[o("text",ABP.Strings.shieldBlockTop)]),o("div",{className:"shield_toggle",id:"blockBottom"},[o("text",ABP.Strings.shieldBlockBottom)]),o("div",{className:"shield_toggle",id:"blockVisitor"},[o("text",ABP.Strings.shieldBlockVisitor)]),o("div",{className:"shield_slide",id:"repeat"},[o("div",{className:"fill"}),o("div",{className:"button"}),o("div",{className:"slide_info"})]),o("div",{style:{padding:"0 16px"}},[o("text",ABP.Strings.shieldRepeat)])])])])])),s.appendChild(o("div",{className:"ABP-Comment-List"},[o("div",{className:"ABP-Comment-List-Count"},[o("div",{style:{position:"absolute",right:"200px"}},[o("span",{id:"viewer",style:{fontWeight:"bold"}},[o("text","--")]),o("text",ABP.Strings.viewers)]),o("div",{style:{position:"absolute",right:"20px"}},[o("span",{id:"danmaku",style:{fontWeight:"bold"}},[o("text","--")]),o("text",ABP.Strings.comments)])]),o("div",{className:"ABP-Comment-List-Title"},[o("div",{className:"cmt-time",item:"time"},[o("text",ABP.Strings.commentTime)]),o("div",{className:"cmt-content",item:"content"},[o("text",ABP.Strings.commentContent)]),o("div",{className:"cmt-date",item:"date"},[o("text",ABP.Strings.commentDate)])]),o("div",{className:"ABP-Comment-List-Container"},[o("ul",{className:"ABP-Comment-List-Container-Inner"})])])),s.appendChild(o("div",{className:"Context-Menu"},[o("div",{className:"Context-Menu-Background"}),o("div",{className:"Context-Menu-Body"},[o("div",{id:"Player-Stats-Toggle"},[o("text",ABP.Strings.showStats)]),o("div",{id:"Player-Speed-Control",className:"dm"},[o("div",{className:"content"},[o("text",ABP.Strings.playSpeed)]),o("div",{className:"dmMenu",style:{top:"-37px"}},[o("div",{"data-speed":.5},[o("text",.5)]),o("div",{"data-speed":1},[o("text",1)]),o("div",{"data-speed":1.25},[o("text",1.25)]),o("div",{"data-speed":1.5},[o("text",1.5)]),o("div",{"data-speed":2},[o("text",2)])])]),o("div",{className:"about"},[o("text",t)])])]));var y=ABP.bind(s);if(r.length>0){var h=r[0];y.gotoNext=function(){var t=r.indexOf(h)+1;if(t<r.length){h=r[t],h.style.display="";var i=y.video.parentNode;i.removeChild(y.video),i.appendChild(h),y.video.style.display="none",y.video=h,y.swapVideo(h),h[e]("ended",function(){y.gotoNext()})}},h[e]("ended",function(){y.gotoNext()})}return y};var g=function(e){for(var t,i,a=0,n=e.currentTime;a<e.buffered.length;a++)if(n>=e.buffered.start(a)&&n<=e.buffered.end(a)){t=e.buffered.start(a),i=e.buffered.end(a);break}if(a==e.buffered.length)throw"Not in a range";return{start:t,end:i,delta:i-n}};ABP.bind=function(t,i){var l={playerUnit:t,btnPlay:null,barTime:null,barLoad:null,barTimeHitArea:null,barVolume:null,barVolumeHitArea:null,barOpacity:null,barOpacityHitArea:null,barScale:null,barScaleHitArea:null,barSpeed:null,barSpeedHitArea:null,barPlaySpeed:null,barPlaySpeedHitArea:null,btnFont:null,btnColor:null,btnSend:null,controlBar:null,timeLabel:null,timeJump:null,divComment:null,btnWide:null,btnFull:null,btnWebFull:null,btnDm:null,btnLoop:null,btnProp:null,btnAutoOpacity:null,videoDiv:null,btnVolume:null,video:null,txtText:null,commentColor:"ffffff",commentFontSize:25,commentMode:1,displayColor:null,cmManager:null,commentList:null,commentListContainer:null,lastSelectedComment:null,commentCoolDown:1e4,commentScale:ABP.playerConfig.scale?ABP.playerConfig.scale:1,commentSpeed:ABP.playerConfig.speed?ABP.playerConfig.speed:1,proportionalScale:ABP.playerConfig.prop,defaults:{w:0,h:0},state:f(i,{fullscreen:!1,commentVisible:!0,allowRescale:!1,autosize:!1,widescreen:!1}),createPopup:function(e,i){if(t.hasPopup===!0)return!1;var a=o("div",{className:"ABP-Popup"},[o("text",e)]);return a.remove=function(){a.isRemoved||(a.isRemoved=!0,t.removeChild(a),t.hasPopup=!1)},t.appendChild(a),t.hasPopup=!0,"number"==typeof i&&setTimeout(function(){a.remove()},i),a},removePopup:function(){for(var e=t.getElementsByClassName("ABP-Popup"),i=0;i<e.length;i++)null!=e[i].remove?e[i].remove():e[i].parentNode.removeChild(e[i]);t.hasPopup=!1},loadCommentList:function(t,i){i="asc"==i?-1:1;var a=Object.keys(l.commentList).sort(function(e,a){return l.commentList[e][t]<l.commentList[a][t]?i:l.commentList[e][t]>l.commentList[a][t]?-i:0});l.commentObjArray=[];for(b in a){var n=a[b],s=l.commentList[n];if(s&&s.time){var c=o("li",{}),u=o("span",{className:"cmt-time"},[o("text",d(s.time/1e3))]),p=o("span",{className:"cmt-content"},[o("text",s.content)]),v=o("span",{className:"cmt-date"},[o("text",r(s.date,!0))]);m(p,!1,36),m(v,!1,18),p.tooltip(s.content),v.tooltip(r(s.date)),c.appendChild(u),c.appendChild(p),c.appendChild(v),c.data=s,c.originalData=danmaku,8==s.mode?c.style.background="#ffe100":0!=s.pool&&(c.style.background="#20ff20"),c[e]("dblclick",function(){l.video.currentTime=this.data.time/1e3,Je(h.currentTime)}),l.commentObjArray.push(c)}}l.commentListContainer.style.height=24*l.commentObjArray.length+"px",l.renderCommentList(),l.playerUnit.querySelector(".ABP-Comment-List-Count span#danmaku").innerHTML=l.commentObjArray.length},renderCommentList:function(){var t=l.commentListContainer.parentElement.scrollTop,i=parseInt(t/24);l.commentListContainer.innerHTML="";for(var a=i;i+40>=a&&"undefined"!=typeof l.commentObjArray[a];a++){if(a==i&&a>0){var n=l.commentObjArray[a].cloneNode(!0),o=n.getElementsByClassName("cmt-content")[0],s=n.getElementsByClassName("cmt-date")[0];n[e]("dblclick",function(){l.video.currentTime=l.commentObjArray[a].data.time/1e3,Je(h.currentTime)}),m(o,!1,36),m(s,!1,18),o.tooltip(l.commentObjArray[a].data.content),s.tooltip(r(l.commentObjArray[a].data.date)),n.style.paddingTop=24*i+"px"}else var n=l.commentObjArray[a];l.commentObjArray[a].childNodes[0].className=l.commentObjArray[a].data.originalData.isBlocked?"cmt-time blocked":"cmt-time",l.commentListContainer.appendChild(n)}l.commentListContainer.parentElement.scrollTop=t},commentCallback:function(e){e.result?(l.commentList[e.id]=l.commentList[e.tmp_id],delete l.commentList[e.tmp_id]):(delete l.commentList[e.tmp_id],l.createPopup(e.error,5e3))},swapVideo:null},s=function(e,t){var i=localStorage.html5Settings||"{}";i=JSON.parse(i),i[e]=t,localStorage.html5Settings=JSON.stringify(i)};if(l.swapVideo=function(t){var i=function(){if(!We){Je(t.currentTime);try{var e=g(this),i=this.duration,a=e.end/i*100;l.barLoad.style.width=a+"%"}catch(e){return}}};t[e]("timeupdate",i);var a=!1,n=!1,o=!1,s=function(){o=!1,t.removeEventListener("canplay",s),t.paused&&l.btnPlay.click(),void 0!=l.lastTime&&(t.currentTime=l.lastTime,delete l.lastTime),void 0!=l.lastSpeed&&(t.playbackRate=l.lastSpeed,delete l.lastSpeed)},r=function(){var e=t.readyState,i=document.getElementById("info-box");if(!t.ended)switch(e){case 1:isMobile()&&t.paused&&(l.createPopup("请点击播放器开始播放",3e3),l.video.dispatchEvent(new Event("autoPlayFailed")));case 2:0==i.style.opacity&&(i.style.opacity=1),dots.running||dots.runTimer();try{var a=g(t);i.childNodes[0].childNodes[0].innerHTML=ABP.Strings.buffering+" "+Math.floor(100*a.delta)/100+"s"}catch(e){i.childNodes[0].childNodes[0].innerHTML=ABP.Strings.buffering}break;case 3:case 4:1==i.style.opacity&&(i.style.opacity=0,dots.stopTimer())}},d=function(){if(window.cid&&!a&&!n&&!o){var e=JSON.parse(localStorage.playHistory||"{}");e[cid]=0|t.currentTime,localStorage.playHistory=JSON.stringify(e)}},c=function(){if(window.cid){var e=JSON.parse(localStorage.playHistory||"{}");e[cid]&&delete e[cid],localStorage.playHistory=JSON.stringify(e)}};t[e]("autoplay",function(){t[e]("canplay",s)}),t[e]("pause",d),t[e]("ended",function(){a=!0,c()});try{var m=JSON.parse(localStorage.playHistory||"{}");void 0!=m[cid]&&(l.lastTime=m[cid])}catch(e){}window[e]("beforeunload",function(){return d(),null}),l.playerUnit[e]("beforecidchange",function(){d(),o=!0,a=!1}),t[e]("loop",function(){n=t.loop}),t[e]("canplay",s),t[e]("canplay",r),t[e]("waiting",r),t[e]("progress",r),t[e]("ended",function(){l.btnPlay.className="button ABP-Play icon-play",l.videoDiv.className="ABP-Video",window.parent!=window&&parent.h5NextPart&&parent.h5NextPart()}),t[e]("progress",i);var p=!1;t[e]("play",function(){l.btnPlay.className="button ABP-Play ABP-Pause icon-pause",l.btnPlay.tooltip(ABP.Strings.pause),u(l.videoDiv,"ABP-HideCursor")}),t[e]("ratechange",function(){0!==t.playbackRate&&Ke(l.video.playbackRate)});var p=!1;t[e]("pause",function(){l.btnPlay.className="button ABP-Play icon-play",l.btnPlay.tooltip(ABP.Strings.play),p=!1,v(l.videoDiv,"ABP-HideCursor")}),t.isBound=!0},null!==t&&null!==t.getElementsByClassName){l.defaults.w=t.offsetWidth,l.defaults.h=t.offsetHeight;var y=t.getElementsByClassName("ABP-Video");if(!(y.length<=0)){var h=null;l.videoDiv=y[0];for(var b in y[0].children)if(null!=y[0].children[b].tagName&&"VIDEO"===y[0].children[b].tagName.toUpperCase()){h=y[0].children[b];break}var B=y[0].getElementsByClassName("ABP-Container");if(B.length>0&&(l.divComment=B[0]),null!==h){l.video=h,l.video.seek=function(e){this.currentTime=parseFloat(e)/1e3};var S=t.getElementsByClassName("ABP-Play");if(!(S.length<=0)){l.btnPlay=S[0],l.btnPlay.tooltip(ABP.Strings.play),m(l.btnPlay);var P=t.getElementsByClassName("progress-bar");if(!(P.length<=0)){var N=P[0].getElementsByClassName("bar");l.barTimeHitArea=N[0],l.barLoad=N[0].getElementsByClassName("load")[0],l.barTime=N[0].getElementsByClassName("dark")[0];var A=t.getElementsByClassName("time-label");if(!(A.length<=0)){l.timeLabel=A[0];var C=t.getElementsByClassName("ABP-Volume");if(!(C.length<=0)){l.btnVolume=C[0],l.btnVolume.tooltip(ABP.Strings.mute),m(l.btnVolume);var x=t.getElementsByClassName("volume-bar");if(!(x.length<=0)){var k=x[0].getElementsByClassName("bar");l.barVolumeHitArea=k[0],l.barVolume=k[0].getElementsByClassName("load")[0];var w=t.getElementsByClassName("opacity-bar");if(!(w.length<=0)){var w=w[0].getElementsByClassName("bar");l.barOpacityHitArea=w[0],l.barOpacity=w[0].getElementsByClassName("load")[0];var T=t.getElementsByClassName("scale-bar");if(!(T.length<=0)){var T=T[0].getElementsByClassName("bar");l.barScaleHitArea=T[0],l.barScale=T[0].getElementsByClassName("load")[0];var H=t.getElementsByClassName("speed-bar");if(!(H.length<=0)){var H=H[0].getElementsByClassName("bar");l.barSpeedHitArea=H[0],l.barSpeed=H[0].getElementsByClassName("load")[0];var F=t.getElementsByClassName("playSpeed-bar");if(!(F.length<=0)){var F=F[0].getElementsByClassName("bar");l.barPlaySpeedHitArea=F[0],l.barPlaySpeed=F[0].getElementsByClassName("load")[0],t.querySelector(".play-speed-reset")[e]("click",function(){l.video.playbackRate=1});var D=t.getElementsByClassName("prop-checkbox");if(!(D.length<=0)){l.btnAutoOpacity=D[1],l.btnAutoOpacity.tooltip(ABP.Strings.autoOpacityOff),m(l.btnAutoOpacity),l.btnProp=D[0],l.btnProp.tooltip(ABP.Strings.usingCanvas),m(l.btnProp);var L=t.getElementsByClassName("ABP-FullScreen");if(!(L.length<=0)){l.btnFull=L[0],l.btnFull.tooltip(ABP.Strings.fullScreen),m(l.btnFull);var M=t.getElementsByClassName("ABP-Web-FullScreen");if(!(M.length<=0)){l.btnWebFull=M[0],l.btnWebFull.tooltip(ABP.Strings.webFull),m(l.btnWebFull);var E=t.getElementsByClassName("ABP-WideScreen");if(!(E.length<=0)){l.btnWide=E[0],l.btnWide.tooltip(ABP.Strings.wideScreen),m(l.btnWide);var _=t.getElementsByClassName("ABP-Comment-Font");if(!(_.length<=0)){l.btnFont=_[0],l.btnFont.tooltip(ABP.Strings.sendStyle),m(l.btnFont);var O=t.getElementsByClassName("ABP-Comment-Color");if(!(O.length<=0)){l.btnColor=O[0],l.btnColor.tooltip(ABP.Strings.sendColor),m(l.btnColor);var V=t.getElementsByClassName("ABP-Comment-Color-Display");if(!(V.length<=0)){l.displayColor=V[0];var R=t.getElementsByClassName("ABP-Comment-Input");if(!(R.length<=0)){l.txtText=R[0];var z=t.getElementsByClassName("ABP-Comment-List-Container-Inner");if(!(z.length<=0)){l.commentListContainer=z[0];var W=t.getElementsByClassName("ABP-Comment-Send");if(!(W.length<=0)){l.btnSend=W[0],l.btnSend.tooltip(ABP.Strings.sendTooltip),m(l.btnSend);var I=t.getElementsByClassName("ABP-Control");I.length>0&&(l.controlBar=I[0]);var j=t.getElementsByClassName("ABP-CommentShow");if(!(j.length<=0)){l.btnDm=j[0],l.btnDm.tooltip(ABP.Strings.hideComment),m(l.btnDm);var q=t.getElementsByClassName("ABP-Loop");if(!(q.length<=0)){l.btnLoop=q[0],l.btnLoop.tooltip(ABP.Strings.loopOff),m(l.btnLoop);var J={videoDimension:!0,gecko:!0,webkit:!0,videoQuality:!0,flvjs:!0},U=function(e){return document.querySelector(e)},X=function(e){return(1*e).toFixed(2)},Y=">:last-child",Q=U("#player-dimension"+Y),G=U("#video-dimension"+Y),K=(U("#canvas-fps"+Y),U("#buffer-health-column")),Z=U("#realtime-bitrate-column"),$=U("#download-speed-column"),ee=[],te=[],ie=[],ae=U("#buffer-health"+Y),ne='<svg style="width:180px;height:21px"><polyline style="fill:transparent;stroke:#ccc"></polyline><polyline points="1,21 180,21 180,1" style="fill:transparent;stroke:#fff"></polyline></svg>',oe="",le=document.createElement("style"),se=document.createElement("style"),re=document.querySelectorAll(".flvjs>:last-child"),b=0,de=function(e,t){var i,a=0,n=[];t.forEach(function(e){a=e>a?e:a}),0==a&&(a=1);for(i in t)n.push(3*i+","+(20*(1-t[i]/a)+1)+" "+(3*i+3)+","+(20*(1-t[i]/a)+1));e.setAttribute("points",n.join(" "))},ce=!1,me=U("#Player-Stats-Toggle"),ue=function(e){"stats-close"==e.target.id&&e.stopPropagation(),U(".Player-Stats").style.display=ce?"":"block",ce=!ce},pe=-1,ve=0;for(me[e]("click",ue),U("#stats-close")[e]("click",ue);60>b;b++)ee.push(0),te.push(0),ie.push(0);if(K.innerHTML=ne,K=K.querySelector("polyline"),Z.innerHTML=ne,Z=Z.querySelector("polyline"),$.innerHTML=ne,$=$.querySelector("polyline"),void 0==h.videoWidth&&(J.videoDimension=!1,oe+="#video-dimension{display:none}"),void 0==h.mozDecodedFrames&&(J.gecko=!1,oe+=".gecko{display:none}"),void 0==h.webkitDecodedFrameCount&&(J.webkit=!1,oe+=".webkit{display:none}"),void 0==h.getVideoPlaybackQuality&&(J.videoQuality=!1,oe+=".videoQuality{display:none}"),le.innerHTML=oe,document.head.appendChild(le),se.innerHTML=".flvjs{display:none}",document.head.appendChild(se),void 0==window.flvplayer&&(J.flvjs=!1),setInterval(function(){ve^=1,Q.innerHTML=h.offsetWidth+"x"+h.offsetHeight+" *"+devicePixelRatio,J.videoDimension&&(G.innerHTML=h.videoWidth+"x"+h.videoHeight);var e={};try{e=g(h)}catch(e){}if(e=e.delta||0,ee.push(e),ee.shift(),ae.innerHTML=X(e)+"s",ce&&de(K,ee),ce){for(var t,i,a=h.buffered,n=U("#buffer-clips>span"),l=h.duration==1/0?a.end(a.length-1):h.duration,s=[],r=0;r<a.length;r++)r>=n.childNodes.length&&n.appendChild(o("span",{className:"buffer-clip"})),t=a.start(r),i=a.end(r)-t,n.childNodes[r].style.left=X(t/l*100)+"%",n.childNodes[r].style.width=X(i/l*100)+"%",s.push(d(0|t)+" - "+d(t+i|0));for(;r<n.childNodes.length;)n.childNodes[r].remove();n.parentNode.parentNode.childNodes[2].innerHTML=s.join("\n"),U("#buffer-clips>span>div").style.left=X(h.currentTime/l*100)+"%"}if(J.flvjs)if(flvplayer._mediaInfo){
se.innerHTML="";var c,m,r=0,u=flvplayer._mediaInfo,p=flvplayer.statisticsInfo,v=h.currentTime,f=flvplayer._mediaDataSource.segments,y=0,b=0;for(m=0;m<f.length;m++){if(v<=(y+f[m].duration)/1e3){y=v-y/1e3|0;break}y+=f[m].duration,b++}var B=f[m].filesize,S=f[m].duration;U("#mimeType>:last-child").innerHTML=u.mimeType,re[r++].innerHTML=X(u.fps),re[r++].innerHTML=X(u.videoDataRate)+" kbps",re[r++].innerHTML=X(u.audioDataRate)+" kbps",re[r++].innerHTML=X(B/S*8)+" kbps",u.bitrateMap?(u.bitrateMap[b]&&(c=u.bitrateMap[b][y]),void 0!=c?ve&&pe!=(0|h.currentTime)?(pe=0|h.currentTime,re[r++].innerHTML=X(c)+" kbps",te.push(c),te.shift(),ce&&de(Z,te)):r++:re[r++].innerHTML="N/A"):re[r++].innerHTML="N/A",ve&&(ie.push(p.speed),ie.shift(),ce&&de($,ie),re[r++].innerHTML=X(p.speed)+" KB/s",flvplayer._statisticsInfo.speed=0)}else se.innerHTML=".flvjs{display:none}",U("#mimeType>:last-child").innerHTML="video/mp4";if(window.overallBitrate?(U("#overall-bitrate").parentNode.style.display="",U("#overall-bitrate").innerHTML=X(overallBitrate)+" kbps"):U("#overall-bitrate").parentNode.style.display="none",J.gecko&&["mozParsedFrames","mozDecodedFrames","mozPaintedFrames"].forEach(function(e){U("#"+e).innerHTML=h[e]}),J.webkit&&["webkitDecodedFrameCount","webkitDroppedFrameCount"].forEach(function(e){U("#"+e).innerHTML=h[e]}),J.videoQuality){var P=h.getVideoPlaybackQuality();U("#totalVideoFrames").innerHTML=P.totalVideoFrames,U("#droppedVideoFrames").innerHTML=P.droppedVideoFrames}},500),"object"==typeof ABP.playerConfig&&ABP.playerConfig.volume&&(l.video.volume=ABP.playerConfig.volume),h.isBound!==!0){l.swapVideo(h),l.playerUnit.querySelector(".BiliPlus-Scale-Menu .Video-Defination")[e]("click",function(e){if(!e.target.hasAttribute("changeto"))return!1;var t=JSON.parse(e.target.getAttribute("changeto"));changeSrc({target:{value:t[1]}},t[0]),v(e.target.parentNode.querySelector(".on"),"on"),u(e.target,"on")}),l.playerUnit.querySelector(".BiliPlus-Scale-Menu .Video-Scale")[e]("click",function(e){if(!e.target.hasAttribute("changeto"))return!1;switch(e.target.getAttribute("changeto")){case"default":p(l.video,"scale")&&v(l.video,"scale"),l.video.style.width="",l.video.style.height="",l.video.style.paddingTop="",l.video.style.paddingLeft="";break;case"16_9":u(l.video,"scale");var t=l.videoDiv.offsetWidth,i=l.videoDiv.offsetHeight,a="",n="";i/9*16>t?(a=(i-t/16*9)/2+"px",i=t/16*9/i*100+"%",t="100%"):(n=(t-i/9*16)/2+"px",t=i/9*16/t*100+"%",i="100%"),l.video.style.width=t,l.video.style.height=i,l.video.style.paddingTop=a,l.video.style.paddingLeft=n;break;case"4_3":u(l.video,"scale");var t=l.videoDiv.offsetWidth,i=l.videoDiv.offsetHeight,a="",n="";i/3*4>t?(a=(i-t/4*3)/2+"px",i=t/4*3/i*100+"%",t="100%"):(n=(t-i/3*4)/2+"px",t=i/3*4/t*100+"%",i="100%"),l.video.style.width=t,l.video.style.height=i,l.video.style.paddingTop=a,l.video.style.paddingLeft=n;break;case"full":u(l.video,"scale"),l.video.style.width="",l.video.style.height="",l.video.style.paddingTop="",l.video.style.paddingLeft=""}v(e.target.parentNode.querySelector(".on"),"on"),u(e.target,"on")});var fe=!1;h[e]("autoPlayFailed",function(){fe=!0});var ge,ye=0,he=function(e){var t=Date.now();500>=t-ye?(l.btnFull.click(),200>=t-ye?clearTimeout(ge):l.btnPlay.click()):fe?(l.btnPlay.click(),fe=!1):ge=setTimeout(function(){l.btnPlay.click()},250),ye=t,e.preventDefault()};l.videoDiv[e]("click",he),l.playerUnit.querySelector(".ABP-Bottom-Extend")[e]("click",function(e){e.preventDefault(),e.stopPropagation(),he(e)});var be=setTimeout(function(){u(l.videoDiv,"ABP-HideCursor")},3e3);l.videoDiv[e]("mousemove",function(e){a(e)||be&&clearTimeout(be),p(l.videoDiv,"ABP-HideCursor")&&v(l.videoDiv,"ABP-HideCursor"),be=setTimeout(function(){u(l.videoDiv,"ABP-HideCursor")},3e3)}),l.btnVolume[e]("click",function(){if(0==l.video.muted){if(l.video.muted=!0,0==l.video.muted)return void this.tooltip(ABP.Strings.muteNotSupported);this.className="button ABP-Volume icon-volume-mute2",this.tooltip(ABP.Strings.unmute),l.barVolume.style.width="0%"}else l.video.muted=!1,this.className="button ABP-Volume icon-volume-",this.className+=l.video.volume<.1?"mute":l.video.volume<.33?"low":l.video.volume<.67?"medium":"high",this.tooltip(ABP.Strings.mute),l.barVolume.style.width=100*l.video.volume+"%"}),l.btnWebFull[e]("click",function(){l.state.fullscreen=p(t,"ABP-FullScreen"),u(t,"ABP-FullScreen"),l.btnFull.className="button ABP-FullScreen icon-screen-normal",l.btnFull.tooltip(ABP.Strings.exitWebFull),l.state.fullscreen=!0,!l.state.allowRescale});var Be=function(){!document.isFullScreen()&&p(t,"ABP-FullScreen")&&(v(t,"ABP-FullScreen"),l.btnFull.className="button ABP-FullScreen icon-screen-full",l.btnFull.tooltip(ABP.Strings.fullScreen),l.state.fullscreen=!!document.isFullScreen())};document[e]("fullscreenchange",Be,!1),document[e]("webkitfullscreenchange",Be,!1),document[e]("mozfullscreenchange",Be,!1),document[e]("MSFullscreenChange",Be,!1),l.btnFull[e]("click",function(){l.state.fullscreen=p(t,"ABP-FullScreen"),l.state.fullscreen?(v(t,"ABP-FullScreen"),this.className="button ABP-FullScreen icon-screen-full",this.tooltip(ABP.Strings.fullScreen),document.exitFullscreen()):(u(t,"ABP-FullScreen"),this.className="button ABP-FullScreen icon-screen-normal",this.tooltip(ABP.Strings.exitFullScreen),t.requestFullScreen()),l.state.fullscreen=!l.state.fullscreen,!l.state.allowRescale}),l.btnWide[e]("click",function(){l.state.widescreen=p(t,"ABP-WideScreen"),l.state.widescreen?(v(t,"ABP-WideScreen"),this.className="button ABP-WideScreen icon-tv",t.dispatchEvent(new Event("normal")),this.tooltip(ABP.Strings.wideScreen)):(u(t,"ABP-WideScreen"),this.className="button ABP-WideScreen icon-tv on",t.dispatchEvent(new Event("wide")),this.tooltip(ABP.Strings.exitWideScreen)),l.state.widescreen=!l.state.widescreen,!l.state.allowRescale}),l.btnLoop[e]("click",function(){0==l.video.loop?(l.video.loop=!0,this.className="button ABP-Loop icon-loop on",this.tooltip(ABP.Strings.loopOn)):(l.video.loop=!1,this.className="button ABP-Loop icon-loop",this.tooltip(ABP.Strings.loopOff)),l.video.dispatchEvent(new CustomEvent("loop"))});var Se,Pe,Ne,Ae=l.playerUnit.querySelector(".Context-Menu"),Ce=Ae.querySelector(".Context-Menu-Background"),xe=Ae.querySelector(".Context-Menu-Body"),ke=function(e){return Me?(e.preventDefault(),e.stopPropagation(),Me=!1,!1):(Ae.style.display="none",void e.preventDefault())},we=null,Te=0,He=null,Fe={},De=function(e,t){Ae.style.display="block";var i,a=xe.querySelectorAll(".dm"),n=l.playerUnit.getBoundingClientRect();for(b=a.length-3;b>=0;b--)a[b].remove();i=xe.firstChild,e-=n.left,t-=n.top,n.width-e<300&&(e=n.width-300),n.height-xe.offsetHeight-t<0&&(t=n.height-xe.offsetHeight);var o=xe.querySelector(".dm:nth-last-of-type(2)>.dmMenu");if(null!=o){o.style.display="block";var s=o.getBoundingClientRect();o.style.display="",n.top+n.height-s.height-t<0&&(t=n.height-s.height)}xe.style.left=e+"px",xe.style.top=t+"px"},Le=null,Me=!1,Ee=!1,_e=!1,Oe=!1,Ve=null;xe.querySelector("#Player-Speed-Control .dmMenu")[e]("click",function(e){var t=e.target.getAttribute("data-speed");void 0!=t&&(l.video.playbackRate=t)}),xe[e]("senderInfoFetched",function(t){var i=t.detail;if(i.mid==Te&&null!=He){var a=He.parentNode.getBoundingClientRect(),n=a.left-150,l=innerHeight-a.bottom,s=o("div",{className:"Context-Menu-Body",id:"Sender-Info",style:{left:n+"px",bottom:l+"px",position:"fixed",fontFamily:"-apple-system,Arial,'PingFang SC','STHeiti Light','Hiragino Kaku Gothic ProN','Microsoft YaHei'",textAlign:"center"}},[o("div",{},[o("img",{style:{height:"130px",width:"130px"},src:i.face.replace(/http\:/,"")})]),o("div",{},[o("text",i.name)]),o("div",{},[o("text",i.mid)]),o("div",{},[o("text","LV"+i.level_info.current_level)])]);document.body.appendChild(s),l+s.offsetHeight>innerHeight&&(s.style.bottom="",s.style.top=a.top+"px"),s[e]("click",function(){window.open("/space/"+i.mid+"/"),document.body.removeChild(s)}),s[e]("mouseenter",function(){clearTimeout(we)}),s[e]("mouseleave",function(){clearTimeout(we),we=setTimeout(function(){document.body.removeChild(document.getElementById("Sender-Info"))},500)})}}),window.getSenderInfo=function(e){0==e.code&&(Fe[Te]=e.card,xe.dispatchEvent(new CustomEvent("senderInfoFetched",{detail:e.card})))},Ae[e]("click",ke),Ce[e]("contextmenu",ke),l.videoDiv.parentNode[e]("contextmenu",function(e){e.preventDefault(),e.stopPropagation();var t=(l.divComment.getBoundingClientRect(),e.clientX),i=e.clientY;De(t,i)}),l.commentListContainer[e]("contextmenu",function(e){var t=e.target.parentNode.data;return void 0==t?!1:(e.preventDefault(),e.stopPropagation(),void De(e.clientX,e.clientY,[t]))}),l.videoDiv.parentNode[e]("touchstart",function(e){if(Ee=!1,_e=!1,Ne=l.video.currentTime,Me=!1,e.touches.length>1&&null!=Le)return clearTimeout(Le),void(Le=null);var t=(l.divComment.getBoundingClientRect(),e.touches[0].clientX),i=e.touches[0].clientY;Pe=i,Le=setTimeout(function(){_e=!0,Le=null,Me=!0,De(t,i)},300)}),l.playerUnit.querySelector(".shield").addEventListener("touchstart touchmove touchend",function(e){e.stopPropagation()}),l.videoDiv.parentNode[e]("touchmove",function(e){null!=Le&&(clearTimeout(Le),Le=null);var t=e.touches[0].clientX,i=e.touches[0].clientY,a=t-Se,n=i-Pe,o=l.videoDiv.getBoundingClientRect(),s=(o.width,o.height);if(Ee){var r=0,c=a>0?1:0,m=["Low","Med","High"],u=l.video.duration;s/3>i?Ne+=.2*a:2*s/3>i?(Ne+=.6*a,r=1):(Ne+=1.5*a,r=2),Ne=0>Ne?0:Ne>u?u:Ne,Se+=a,Se-o.left<50||o.right-Se<50?(document.querySelector(".Drag-Icon").className="Drag-Icon cancel",U(".Drag-Speed").innerHTML=ABP.Strings.dragControlCancel,U(".Drag-Time").innerHTML="　",Oe=!0):(document.querySelector(".Drag-Icon").className="Drag-Icon "+(c?"forward":"rewind"),U(".Drag-Speed").innerHTML=ABP.Strings["dragControl"+m[r]+(c?"Inc":"Dec")],U(".Drag-Time").innerHTML=d(Ne)+"╱"+d(u),Oe=!1,u>0&&(document.querySelector(".Drag-Time-Bar .fill").style.width=Ne/u*100+"%"))}else _e||(-10>a||a>10?(Ee=!0,null!=Ve&&(clearTimeout(Ve),Ve=null),U(".Drag-Control").style.display="block"):(-10>n||n>10)&&(_e=!0))}),l.videoDiv.parentNode[e]("touchend",function(){null!=Le&&(clearTimeout(Le),Le=null),Ee&&!Oe&&(l.video.currentTime=Ne),Ve=setTimeout(function(){U(".Drag-Control").style.display="none"},1e3)}),xe[e]("touchstart",function(e){var t=xe.getBoundingClientRect();e.touches[0].clientX-t.left<=t.width&&e.touches[0].clientY-t.top<=t.height&&(Me=!0)});var Re=function(){},ze=function(){};l.txtText.parentNode[e]("submit",function(e){return e.preventDefault(),ze(),!1}),l.btnSend[e]("click",ze),l.timeLabel[e]("click",function(){l.timeJump=o("input",{className:"time-jump"}),l.timeJump.value=d(l.video.currentTime),l.controlBar.appendChild(l.timeJump),l.timeJump[e]("blur",function(){l.timeJump&&l.timeJump.parentNode.removeChild(l.timeJump),l.timeJump=null}),l.timeJump[e]("keydown",function(e){if(13==e.keyCode){var t=c(l.timeJump.value);t&&t<=l.video.duration&&(l.video.currentTime=t,l.video.paused&&l.btnPlay.click()),l.timeJump.parentNode.removeChild(l.timeJump)}else(e.keyCode<48||e.keyCode>59)&&(e.keyCode<96||e.keyCode>105)&&8!=e.keyCode&&16!=e.keyCode&&37!=e.keyCode&&39!=e.keyCode&&46!=e.keyCode&&e.preventDefault()}),l.timeJump.focus(),l.timeJump.select()}),l.barTime.style.width="0%";var We=!1;l.barTimeHitArea[e]("mousedown",function(){We=!0});var Ie={imgs:[],data:[],len:[0,0],size:[0,0]},je=function(e){if(0!=e.code)return!1;Ie.imgs=JSON.parse(JSON.stringify(e.data.image).replace(/http:/g,"https:")),Ie.len=[e.data.img_x_len,e.data.img_y_len],Ie.size=[e.data.img_x_size,e.data.img_y_size];for(var t=0,i=[];t<100*Ie.imgs.length;t++)i.push(t*e.data.step);Ie.data=i},qe=!1;l.barTimeHitArea[e]("mouseenter",function(){qe=!0}),l.barTimeHitArea[e]("mouseleave",function(){qe=!1}),l.playerUnit[e]("previewData",function(e){je(e.detail)}),document[e]("mouseup",function(e){if(We){var t=(e.clientX-l.barTimeHitArea.getBoundingClientRect().left)/l.barTimeHitArea.offsetWidth*l.video.duration;0>t&&(t=0),Math.abs(t-l.video.currentTime)>4&&l.cmManager&&l.cmManager.clear(),l.video.currentTime=t}We=!1});var Je=function(e){l.barTime.style.width=e/h.duration*100+"%",l.timeLabel.innerHTML=d(e)+" / "+d(h.duration)};document[e]("mousemove",function(e){var t=(e.clientX-l.barTimeHitArea.getBoundingClientRect().left)/l.barTimeHitArea.offsetWidth*l.video.duration;if(0>t&&(t=0),t>l.video.duration&&(t=l.video.duration),Ie.data.length>0&&null!=n("ABP-Tooltip")&&qe){var i;for(i=0;i<Ie.data.length;i++)if(t<Ie.data[i]){i--;break}var a=Math.floor(i/100),s=Math.floor(i%100/10),r=i%10,c=n("preview-container"),m=n("ABP-Tooltip");null==c&&(c=o("div",{id:"preview-container",style:{position:"absolute","background-size":Ie.size[0]+"px "+Ie.size[1]+"px",width:Ie.size[0]+"px",height:Ie.size[1]+"px",background:"rgba(0,0,0,0)",display:"none"}}),m.parentNode.insertBefore(c,m)),c.style.left=m.offsetLeft+(m.offsetWidth-Ie.size[0])/2+"px",c.style.top=m.offsetTop+(m.offsetHeight-Ie.size[1])+"px",c.style.display="block",c.style.backgroundImage='url("'+Ie.imgs[a]+'")',c.style.backgroundPosition="-"+r*Ie.size[0]+"px -"+s*Ie.size[1]+"px"}null==n("ABP-Tooltip")&&null!=n("preview-container")&&(n("preview-container").style.display="none"),l.barTimeHitArea.tooltip(d(t)),We&&Je(t)}),m(l.barTimeHitArea,!0,-12);var Ue=!1;l.barVolumeHitArea[e]("mousedown",function(){Ue=!0}),l.barVolume.style.width=100*l.video.volume+"%";var Xe=function(e){l.barVolume.style.width=100*e+"%",l.video.muted=!1,l.btnVolume.className="button ABP-Volume icon-volume-",l.btnVolume.className+=.1>e?"mute":.33>e?"low":.67>e?"medium":"high",l.btnVolume.tooltip(ABP.Strings.mute),l.barVolumeHitArea.tooltip(parseInt(100*e)+"%"),Re()};document[e]("mouseup",function(e){if(Ue){var t=(e.clientX-l.barVolumeHitArea.getBoundingClientRect().left)/l.barVolumeHitArea.offsetWidth;0>t&&(t=0),t>1&&(t=1),l.video.volume=t,Xe(l.video.volume)}Ue=!1}),document[e]("mousemove",function(e){var t=(e.clientX-l.barVolumeHitArea.getBoundingClientRect().left)/l.barVolumeHitArea.offsetWidth;0>t&&(t=0),t>1&&(t=1),Ue?(l.video.volume=t,Xe(l.video.volume)):l.barVolumeHitArea.tooltip(parseInt(100*t)+"%")}),m(l.barVolumeHitArea,!0,-12);var Ye=!1;l.barSpeedHitArea[e]("mousedown",function(){Ye=!0}),l.barSpeed.style.width=(l.commentSpeed-.5)/1.5*100+"%";var Qe=function(e){l.barSpeed.style.width=(e-.5)/1.5*100+"%",l.barSpeedHitArea.tooltip(parseInt(100*e)+"%"),Re()};document[e]("mouseup",function(e){if(Ye){var t=.5+1.5*(e.clientX-l.barSpeedHitArea.getBoundingClientRect().left)/l.barSpeedHitArea.offsetWidth;.5>t&&(t=.5),t>2&&(t=2),l.commentSpeed=t,Qe(l.commentSpeed),s.speed()}Ye=!1}),document[e]("mousemove",function(e){var t=.5+1.5*(e.clientX-l.barSpeedHitArea.getBoundingClientRect().left)/l.barSpeedHitArea.offsetWidth;.5>t&&(t=.5),t>2&&(t=2),Ye?(l.commentSpeed=t,Qe(l.commentSpeed)):l.barSpeedHitArea.tooltip(parseInt(100*t)+"%")}),m(l.barSpeedHitArea,!0,-6);var Ge=!1;l.barPlaySpeedHitArea[e]("mousedown",function(){Ge=!0}),l.barPlaySpeed.style.width=(l.video.playbackRate-.5)/1.5*100+"%";var Ke=function(e){l.barPlaySpeed.style.width=(e-.5)/1.5*100+"%",l.barPlaySpeedHitArea.tooltip(e.toFixed(2)+"x")};document[e]("mouseup",function(e){if(Ge){var t=.5+1.5*(e.clientX-l.barPlaySpeedHitArea.getBoundingClientRect().left)/l.barPlaySpeedHitArea.offsetWidth;.5>t&&(t=.5),t>2&&(t=2),l.video.playbackRate=t}Ge=!1}),document[e]("mousemove",function(e){var t=.5+1.5*(e.clientX-l.barPlaySpeedHitArea.getBoundingClientRect().left)/l.barPlaySpeedHitArea.offsetWidth;.5>t&&(t=.5),t>2&&(t=2),Ge?l.video.playbackRate=t:l.barPlaySpeedHitArea.tooltip(t.toFixed(2)+"x")}),m(l.barPlaySpeedHitArea,!0,-6),l.btnPlay[e]("click",function(){l.video.paused?l.video.play():l.video.pause()}),t[e]("keydown",function(e){if(e&&"INPUT"!=document.activeElement.tagName)switch(-1!=[27,32,37,38,39,40].indexOf(e.keyCode)&&e.preventDefault(),e.keyCode){case 27:abpinst.state.fullscreen&&abpinst.btnFull.click();break;case 32:l.btnPlay.click();break;case 37:var t=l.video.currentTime-=5*l.video.playbackRate;0>t&&(t=0),l.video.currentTime=t.toFixed(3),l.video.paused&&l.btnPlay.click(),Je(h.currentTime),l.barTimeHitArea.tooltip(d(h.currentTime));break;case 39:var t=l.video.currentTime+=5*l.video.playbackRate;t>l.video.duration&&(t=l.video.duration),l.video.currentTime=t.toFixed(3),l.video.paused&&l.btnPlay.click(),Je(h.currentTime),l.barTimeHitArea.tooltip(d(h.currentTime));break;case 38:var i=l.video.volume+.1;i>1&&(i=1),l.video.volume=i.toFixed(3),Xe(l.video.volume);break;case 40:var i=l.video.volume-.1;0>i&&(i=0),l.video.volume=i.toFixed(3),Xe(l.video.volume)}}),t[e]("touchmove",function(e){e.preventDefault()});var Ze=null;t[e]("touchstart",function(e){p(l.videoDiv,"ABP-HideCursor")&&v(l.videoDiv,"ABP-HideCursor"),e.targetTouches.length>0&&(Ze=e.targetTouches[0])}),t[e]("touchend",function(e){if(u(l.videoDiv,"ABP-HideCursor"),e.changedTouches.length>0&&null!=Ze){var t=e.changedTouches[0].pageX-Ze.pageX,i=e.changedTouches[0].pageY-Ze.pageY;if(Math.abs(t)<20&&Math.abs(i)<20)return void(Ze=null);Math.abs(t)>3*Math.abs(i)?t>0?l.video.paused&&l.btnPlay.click():l.video.paused||l.btnPlay.click():Math.abs(i)>3*Math.abs(t)&&(l.video.volume=0>i?Math.min(1,l.video.volume+.1):Math.max(0,l.video.volume-.1)),Ze=null}}),t[e]("mouseup",function(){if("INPUT"!=document.activeElement.tagName){var e=window.scrollY;l.videoDiv.focus(),window.scrollTo(window.scrollX,e)}})}return l}}}}}}}}}}}}}}}}}}}}}}}}}}}();