function isMobile(){var e=!1;return function(t){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4)))&&(e=!0)}(navigator.userAgent||navigator.vendor||window.opera),e}Array.from=Array.from||function(e){return[].slice.call(e)};var ABP={version:"0.8.0"};ABP.Strings={statsPlayer:"播放器尺寸：",statsVideo:"视频分辨率：",statsBuffer:"可用缓冲：",statsBufferClip:"缓冲片段：",statsMozParse:"已解析帧：",statsMozDecode:"已解码帧：",statsMozPaint:"已绘制帧：",statsWebkitDecode:"已解码帧：",statsPresent:"已显示帧：",statsDrop:"已丢弃帧：",statsMimetype:"文件格式：",statsVideoBitrate:"本段视频码率：",statsAudioBitrate:"本段音频码率：",statsCurrentBitrate:"本段码率：",statsRealtimeBitrate:"实时码率：",overallBitrate:"总体码率：",statsDownloadSpeed:"下载速度：",sendSmall:"小字号",sendMid:"中字号",sendSize:"弹幕字号",sendMode:"弹幕模式",sendTop:"顶端渐隐",sendScroll:"滚动字幕",sendBottom:"底端渐隐",send:"发送",sendStyle:"弹幕样式",sendColor:"弹幕颜色",commentSpeed:"弹幕速度",commentScale:"弹幕比例",commentOpacity:"弹幕不透明度",commentBlock:"弹幕屏蔽设定",playSpeed:"播放速度",playSpeedReset:"还原正常速度",displayScaleD:"默认",displayScaleF:"全屏",shieldTypeText:"文字",shieldTypeUser:"用户",shieldTypeColor:"颜色",shieldTypeSetting:"设置",shieldAdd:"添加屏蔽……",shieldUseRegex:"启用正则",shieldBlockTop:"屏蔽顶端弹幕",shieldBlockBottom:"屏蔽底端弹幕",shieldBlockVisitor:"屏蔽游客弹幕",shieldRepeat:"去除刷屏弹幕",viewers:" 观众",comments:" 弹幕",commentTime:"时间",commentContent:"评论",commentDate:"发送日期",showStats:"显示统计信息",loadingMeta:"正在加载视频信息",switching:"正在切换",fetchURL:"正在获取视频地址",buffering:"正在缓冲",play:"播放",pause:"暂停",mute:"静音",unmute:"取消静音",muteNotSupported:"不支持静音",fullScreen:"全屏",exitFullScreen:"退出全屏",webFull:"网页全屏",exitWebFull:"退出网页全屏",wideScreen:"宽屏模式",exitWideScreen:"退出宽屏",sendTooltip:"毁灭地喷射白光!da!",showComment:"显示弹幕",hideComment:"隐藏弹幕",loopOn:"洗脑循环 on",loopOff:"洗脑循环 off",usingCanvas:"正在使用Canvas",usingCSS:"正在使用CSS",useCSS:"使用CSS绘制弹幕",autoOpacityOn:"关闭自动不透明度",autoOpacityOff:"开启自动不透明度",copyComment:"复制弹幕",findComment:"定位弹幕",blockContent:"屏蔽内容",blockUser:"屏蔽发送者",blockColor:"屏蔽颜色",blockColorWhite:"不能屏蔽白色",copyFail:"复制失败，浏览器不支持",blockUserEmpty:"没有屏蔽用户",blockColorEmpty:"没有屏蔽颜色",repeatPcs:"条",repeatUnlimited:"不限制",dragControlLowInc:"低速快进",dragControlLowDec:"低速快退",dragControlMedInc:"中速快进",dragControlMedDec:"中速快退",dragControlHighInc:"高速快进",dragControlHighDec:"高速快退",dragControlCancel:"取消跳转"},function(){"use strict";if(ABP){var e=jQuery,t="addEventListener",i="HTML5 Player ver.170512 based on ABPlayer-bilibili-ver",a=[0,0],o=function(e){var t=a;return a=[e.clientX,e.clientY],t[0]==a[0]&&t[1]==a[1]},n=function(e){return document.getElementById(e)},l=function(e,t,i,a){var o=null;if("text"===e)return document.createTextNode(t);o=document.createElement(e);for(var n in t)if("style"!==n&&"className"!==n)o.setAttribute(n,t[n]);else if("className"===n)o.className=t[n];else for(var l in t.style)o.style[l]=t.style[l];if(i)for(var s=0;s<i.length;s++)null!=i[s]&&o.appendChild(i[s]);return a&&"function"==typeof a&&a(o),o},s=function(e,t){for(;e;e=e.parentNode)if(f(e.parentNode,t))return e};HTMLElement.prototype.tooltip=function(e){this.tooltipData=e,this.dispatchEvent(new Event("updatetooltip"))},"undefined"==typeof HTMLElement.prototype.requestFullScreen&&(HTMLElement.prototype.requestFullScreen=function(){this.webkitRequestFullscreen?this.webkitRequestFullscreen():this.mozRequestFullScreen?this.mozRequestFullScreen():this.msRequestFullscreen&&this.msRequestFullscreen()}),"undefined"==typeof document.isFullScreen&&(document.isFullScreen=function(){return document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenEnabled}),"undefined"==typeof document.exitFullscreen&&(document.exitFullscreen=function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():window.msExitFullscreen&&msExitFullscreen()});var r=function(e,t){t=t||2;for(var i=""+e;i.length<t;)i="0"+i;return i},c=function(e,t){for(var i="",a=1;a<=t-(e+"").length;a++)i+="0";return i+e},d=function(e,t){if(0==e)return lang.oneDay;var i,a,o,n,l,s,r=new Date(1e3*parseInt(e));return i=String(r.getFullYear()),a=String(r.getMonth()+1),1==a.length&&(a="0"+a),o=String(r.getDate()),1==o.length&&(o="0"+o),n=String(r.getHours()),1==n.length&&(n="0"+n),l=String(r.getMinutes()),1==l.length&&(l="0"+l),s=String(r.getSeconds()),1==s.length&&(s="0"+s),String(t?a+"-"+o+" "+n+":"+l:i+"-"+a+"-"+o+" "+n+":"+l+":"+s)},m=function(e){return isNaN(e)?"00:00":c(parseInt(e/60),2)+":"+c(parseInt(e%60),2)},u=function(e){for(var t=e.split(":"),i=0,a=0;a<t.length;a++){i*=60;var o=parseInt(t[a]);if(isNaN(o)||0>o)return!1;i+=o}return i},p=function(e,i,a){if(e){e[t]("mousemove",function(t){var o,r=n("ABP-Tooltip"),c=e.clientWidth,d=e.clientHeight,m=e.getBoundingClientRect(),u=s(e,"ABP-Unit").getBoundingClientRect(),p=m.top-u.top,v=i?t.clientX-u.left:m.left-u.left,f=v;null==r&&(r=l("div",{id:"ABP-Tooltip"},[l("text",e.tooltipData)]),r.by=e,s(e,"ABP-Unit").appendChild(r),r.style.top=p+d+2+"px",r.style.left=v+c/2-r.clientWidth/2+"px",f+=c/2-r.clientWidth/2),i&&(r.style.left=v-r.clientWidth/2+"px",f-=c/2),o=r.getBoundingClientRect(),o.left<u.left?r.style.left="0px":o.right>u.right&&(r.style.left=u.width-o.width+"px"),a=a||-6,a&&(r.style.top=p-r.clientHeight+2+a+"px")});var o=function(){var e=n("ABP-Tooltip");e&&e.parentNode&&e.remove()},r=null;e[t]("mouseout",o),e[t]("touchend",function(){null!=r&&(clearTimeout(r),r=null),r=setTimeout(function(){r=null,o()},2e3)}),e[t]("updatetooltip",function(t){var i=n("ABP-Tooltip");i&&i.by==t.target&&(i.innerHTML=e.tooltipData)})}},v=function(e,t){if(null!=e){var i=e.className.split(" ");""==i[0]&&(i=[]),i.indexOf(t)<0&&i.push(t),e.className=i.join(" ")}},f=function(e,t){if(null==e)return!1;var i=e.className.split(" ");return""==i[0]&&(i=[]),i.indexOf(t)>=0},g=function(e,t){if(null!=e){var i=e.className.split(" ");""==i[0]&&(i=[]),i.indexOf(t)>=0&&i.splice(i.indexOf(t),1),e.className=i.join(" ")}},h=function(e,t){var i={};for(var a in t)i[a]=e&&"undefined"!=typeof e[a]?e[a]:t[a];return i};ABP.create=function(e,a){var o=e;if(a||(a={}),ABP.playerConfig=a.config?a.config:{},a=h(a,{replaceMode:!0,width:512,height:384,src:""}),"string"==typeof e&&(o=n(e)),f(o,"ABP-Unit"))s=o;else{var s=l("div",{className:"ABP-Unit",style:{width:a.width.toString().indexOf("%")>=0?a.width:a.width+"px",height:a.height.toString().indexOf("%")>=0?a.height:a.height+"px"}});o.appendChild(s)}s.children.length>0&&a.replaceMode&&(s.innerHTML="");var r=[],c=[];if("string"==typeof a.src)a.src=l("video",{autobuffer:"true",dataSetup:"{}"},[l("source",{src:a.src})]),r.push(a.src);else if(a.src.hasOwnProperty("playlist"))for(var d=a.src,m=d.playlist,u=0;u<m.length;u++){if(m[u].hasOwnProperty("sources")){var p=[];for(var v in m[u].sources)p.push(l("source",{src:m[u][v],type:v}));r.push(l("video",{autobuffer:"true",dataSetup:"{}"},p))}else m[u].hasOwnProperty("video")&&r.push(m[u].video);c.push(m[u].comments)}else r.push(a.src);s.appendChild(l("div",{className:"ABP-Player"},[l("div",{className:"ABP-Video",tabindex:"10"},[l("div",{id:"info-box",style:{opacity:1}},[l("div",{className:"text-wrapper"},[l("div",{},[l("text",ABP.Strings.loadingMeta)])]),l("div",{id:"dots"})]),l("div",{className:"ABP-Container"}),r[0],l("div",{className:"Player-Stats"},[l("div",{id:"player-dimension"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsPlayer)]),l("span")]),l("div",{id:"video-dimension"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsVideo)]),l("span")]),l("div",{id:"mimeType"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsMimetype)]),l("span")]),l("div",{id:"buffer-health"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsBuffer)]),l("span",{className:"stats-column",id:"buffer-health-column"}),l("span")]),l("div",{style:{position:"relative"}},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsBufferClip)]),l("span",{id:"buffer-clips"},[l("span"),l("span",{},[l("div",{style:{width:"1px",height:"400%",top:"-150%",position:"absolute",background:"#FFF",left:0}})])]),l("pre",{style:{position:"absolute",margin:0,left:"250px",width:"90px",fontFamily:"inherit"}})]),l("br",{className:"flvjs"}),l("div",{className:"flvjs"},[l("span",{className:"stats_name"},[l("text","fps：")]),l("span")]),l("div",{className:"flvjs",title:"1 kbps = 1000 bps"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsVideoBitrate)]),l("span")]),l("div",{className:"flvjs",title:"1 kbps = 1000 bps"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsAudioBitrate)]),l("span")]),l("div",{className:"flvjs",title:"1 kbps = 1000 bps"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsCurrentBitrate)]),l("span")]),l("div",{title:"1 kbps = 1000 bps"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.overallBitrate)]),l("span",{id:"overall-bitrate"})]),l("div",{className:"flvjs",title:"1 kbps = 1000 bps"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsRealtimeBitrate)]),l("span",{className:"stats-column",id:"realtime-bitrate-column",style:{verticalAlign:"top"}}),l("span")]),l("div",{className:"flvjs"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsDownloadSpeed)]),l("span",{className:"stats-column",id:"download-speed-column",style:{verticalAlign:"top"}}),l("span")]),l("br"),l("div",{id:"canvas-fps"},[l("span",{className:"stats_name"},[l("text","Canvas fps：")]),l("span")]),l("div",{className:"gecko"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsMozParse)]),l("span",{id:"mozParsedFrames"})]),l("div",{className:"gecko"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsMozDecode)]),l("span",{id:"mozDecodedFrames"})]),l("div",{className:"gecko"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsMozPaint)]),l("span",{id:"mozPaintedFrames"})]),l("div",{className:"webkit"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsWebkitDecode)]),l("span",{id:"webkitDecodedFrameCount"})]),l("div",{className:"webkit"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsDrop)]),l("span",{id:"webkitDroppedFrameCount"})]),l("div",{className:"videoQuality"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsPresent)]),l("span",{id:"totalVideoFrames"})]),l("div",{className:"videoQuality"},[l("span",{className:"stats_name"},[l("text",ABP.Strings.statsDrop)]),l("span",{id:"droppedVideoFrames"})]),l("br"),l("div",{style:{fontSize:"11px"}},[l("text",i)]),l("div",{style:{fontSize:"11px"}},[l("text","2017©esterTion")]),l("div",{id:"stats-close"},[l("text","×")])]),l("div",{className:"Drag-Control"},[l("div",{className:"Drag-Icon"}),l("div",{className:"Drag-Speed"},[l("text","")]),l("div",{className:"Drag-Time"},[l("text","00:00╱00:00")]),l("div",{className:"Drag-Time-Bar"},[l("div",{className:"fill"})])])]),l("div",{className:"ABP-Bottom"},[l("div",{className:"ABP-Bottom-Extend"}),l("div",{className:"BiliPlus-Scale-Menu"},[l("div",{className:"Video-Defination"}),l("div",{className:"Video-Scale"},[l("div",{changeTo:"default",className:"on"},[l("text",ABP.Strings.displayScaleD)]),l("div",{changeTo:"16_9"},[l("text","16:9")]),l("div",{changeTo:"4_3"},[l("text","4:3")]),l("div",{changeTo:"full"},[l("text",ABP.Strings.displayScaleF)])])]),l("div",{className:"ABP-Text"},[l("div",{className:"ABP-CommentStyle"},[l("div",{className:"button-group ABP-Comment-FontGroup"},[l("div",{className:"button ABP-Comment-Font icon-font-style"}),l("div",{className:"ABP-Comment-FontOption"},[l("p",{className:"style-title"},[l("text",ABP.Strings.sendSize)]),l("div",{className:"style-select",name:"commentFontSize"},[l("div",{className:"style-option",value:18},[l("text",ABP.Strings.sendSmall)]),l("div",{className:"style-option on",value:25},[l("text",ABP.Strings.sendMid)])]),l("p",{className:"style-title"},[l("text",ABP.Strings.sendMode)]),l("div",{className:"style-select",name:"commentMode"},[l("div",{className:"style-option",value:5},[l("text",ABP.Strings.sendTop)]),l("div",{className:"style-option on",value:1},[l("text",ABP.Strings.sendScroll)]),l("div",{className:"style-option",value:4},[l("text",ABP.Strings.sendBottom)])])])]),l("div",{className:"button-group ABP-Comment-ColorGroup"},[l("div",{className:"ABP-Comment-Color-Display"}),l("div",{className:"button ABP-Comment-Color icon-color-mode"}),l("div",{className:"ABP-Comment-ColorOption"},[l("div",{className:"ABP-Comment-ColorPicker"})])])]),l("form",{},[l("input",{className:"ABP-Comment-Input"})]),l("div",{className:"ABP-Comment-Send"},[l("text",ABP.Strings.send)])]),l("div",{className:"ABP-Control"},[l("div",{className:"button ABP-Play icon-play"}),l("div",{className:"progress-bar"},[l("div",{className:"bar"},[l("div",{className:"load"}),l("div",{className:"dark"})])]),l("div",{className:"time-label"},[l("text","00:00 / 00:00")]),l("div",{className:"button ABP-Volume icon-volume-high"}),l("div",{className:"volume-bar"},[l("div",{className:"bar"},[l("div",{className:"load"})])]),l("div",{className:"button-group ABP-CommentGroup"},[l("div",{className:"button ABP-CommentShow icon-comment on"}),l("div",{className:"ABP-CommentOption"},[l("p",{className:"label"},[l("text",ABP.Strings.useCSS),l("div",{className:"prop-checkbox"})]),l("p",{className:"label"},[l("text",ABP.Strings.commentSpeed)]),l("div",{className:"speed-bar"},[l("div",{className:"bar"},[l("div",{className:"load"})])]),l("p",{className:"label"},[l("text",ABP.Strings.commentScale)]),l("div",{className:"scale-bar"},[l("div",{className:"bar"},[l("div",{className:"load"})])]),l("p",{className:"label"},[l("text",ABP.Strings.commentOpacity)]),l("div",{className:"opacity-bar",style:{width:"calc(100% - 25px)"}},[l("div",{className:"bar"},[l("div",{className:"load"})])]),l("div",{className:"prop-checkbox",style:{top:"121px"}}),l("div",{className:"shield-enrty"},[l("text",ABP.Strings.commentBlock)])])]),l("div",{className:"button-group ABP-PlaySpeedGroup"},[l("div",{className:"button ABP-Loop icon-loop"}),l("div",{className:"ABP-PlaySpeedOption"},[l("p",{className:"label"},[l("text",ABP.Strings.playSpeed)]),l("div",{className:"playSpeed-bar"},[l("div",{className:"bar"},[l("div",{className:"load"})])]),l("div",{className:"play-speed-reset"},[l("text",ABP.Strings.playSpeedReset)])])]),l("div",{className:"button ABP-WideScreen icon-tv"}),l("div",{className:"button-group ABP-FullScreenGroup"},[l("div",{className:"button ABP-FullScreen icon-screen-full"}),l("div",{className:"button ABP-Web-FullScreen icon-screen"})])])])])),s.appendChild(l("div",{className:"shield hidden"},[l("div",{className:"shield_top"},[l("text",ABP.Strings.commentBlock),l("span",{className:"close"})]),l("div",{className:"shield_tabs"},[l("div",{className:"shield_tab on"},[l("div",{},[l("text",ABP.Strings.shieldTypeText)])]),l("div",{className:"shield_tab"},[l("div",{},[l("text",ABP.Strings.shieldTypeUser)])]),l("div",{className:"shield_tab"},[l("div",{},[l("text",ABP.Strings.shieldTypeColor)])]),l("div",{className:"shield_tab"},[l("div",{},[l("text",ABP.Strings.shieldTypeSetting)])])]),l("div",{className:"shield_tab_slash"}),l("div",{className:"shield_body"},[l("div",{className:"shield_body_wrapper"},[l("div",{className:"shield_tab_body"},[l("div",{id:"shield_text"}),l("div",{className:"shield_item"},[l("input",{className:"new",type:"text",placeholder:ABP.Strings.shieldAdd}),l("div",{className:"add"})])]),l("div",{className:"shield_tab_body"},[l("div",{id:"shield_user"})]),l("div",{className:"shield_tab_body"},[l("div",{id:"shield_color"})]),l("div",{className:"shield_tab_body"},[l("div",{className:"shield_toggle",id:"useReg"},[l("text",ABP.Strings.shieldUseRegex)]),l("div",{className:"shield_toggle",id:"blockTop"},[l("text",ABP.Strings.shieldBlockTop)]),l("div",{className:"shield_toggle",id:"blockBottom"},[l("text",ABP.Strings.shieldBlockBottom)]),l("div",{className:"shield_toggle",id:"blockVisitor",style:{display:"none"}},[l("text",ABP.Strings.shieldBlockVisitor)]),l("div",{className:"shield_slide",id:"repeat"},[l("div",{className:"fill"}),l("div",{className:"button"}),l("div",{className:"slide_info"})]),l("div",{style:{padding:"0 16px"}},[l("text",ABP.Strings.shieldRepeat)])])])])])),s.appendChild(l("div",{className:"ABP-Comment-List"},[l("div",{className:"ABP-Comment-List-Count"},[l("div",{style:{position:"absolute",right:"200px"}},[l("span",{id:"viewer",style:{fontWeight:"bold"}},[l("text","--")]),l("text",ABP.Strings.viewers)]),l("div",{style:{position:"absolute",right:"20px"}},[l("span",{id:"danmaku",style:{fontWeight:"bold"}},[l("text","--")]),l("text",ABP.Strings.comments)])]),l("div",{className:"ABP-Comment-List-Title"},[l("div",{className:"cmt-time",item:"time"},[l("text",ABP.Strings.commentTime)]),l("div",{className:"cmt-content",item:"content"},[l("text",ABP.Strings.commentContent)]),l("div",{className:"cmt-date",item:"date"},[l("text",ABP.Strings.commentDate)])]),l("div",{className:"ABP-Comment-List-Container"},[l("ul",{className:"ABP-Comment-List-Container-Inner"})])])),s.appendChild(l("div",{className:"Context-Menu"},[l("div",{className:"Context-Menu-Background"}),l("div",{className:"Context-Menu-Body"},[l("div",{id:"Player-Stats-Toggle"},[l("text",ABP.Strings.showStats)]),l("div",{id:"Player-Speed-Control",className:"dm"},[l("div",{className:"content"},[l("text",ABP.Strings.playSpeed)]),l("div",{className:"dmMenu",style:{top:"-37px"}},[l("div",{"data-speed":.5},[l("text",.5)]),l("div",{"data-speed":1},[l("text",1)]),l("div",{"data-speed":1.25},[l("text",1.25)]),l("div",{"data-speed":1.5},[l("text",1.5)]),l("div",{"data-speed":2},[l("text",2)])])]),l("div",{className:"about"},[l("text",i)])])]));var g=ABP.bind(s);if(r.length>0){var b=r[0];g.gotoNext=function(){var e=r.indexOf(b)+1;if(e<r.length){b=r[e],b.style.display="";var i=g.video.parentNode;i.removeChild(g.video),i.appendChild(b),g.video.style.display="none",g.video=b,g.swapVideo(b),b[t]("ended",function(){g.gotoNext()})}},b[t]("ended",function(){g.gotoNext()})}return g};var b=function(e){for(var t,i,a=0,o=e.currentTime;a<e.buffered.length;a++)if(o>=e.buffered.start(a)&&o<=e.buffered.end(a)){t=e.buffered.start(a),i=e.buffered.end(a);break}if(a==e.buffered.length)throw"Not in a range";return{start:t,end:i,delta:i-o}};ABP.bind=function(i,a){var s={playerUnit:i,btnPlay:null,barTime:null,barLoad:null,barTimeHitArea:null,barVolume:null,barVolumeHitArea:null,barOpacity:null,barOpacityHitArea:null,barScale:null,barScaleHitArea:null,barSpeed:null,barSpeedHitArea:null,barPlaySpeed:null,barPlaySpeedHitArea:null,btnFont:null,btnColor:null,btnSend:null,controlBar:null,timeLabel:null,timeJump:null,divComment:null,btnWide:null,btnFull:null,btnWebFull:null,btnDm:null,btnLoop:null,btnProp:null,btnAutoOpacity:null,videoDiv:null,btnVolume:null,video:null,txtText:null,commentColor:"ffffff",commentFontSize:25,commentMode:1,displayColor:null,cmManager:null,commentList:null,commentListContainer:null,lastSelectedComment:null,commentCoolDown:1e4,commentScale:ABP.playerConfig.scale?ABP.playerConfig.scale:1,commentSpeed:ABP.playerConfig.speed?ABP.playerConfig.speed:1,proportionalScale:ABP.playerConfig.prop,defaults:{w:0,h:0},state:h(a,{fullscreen:!1,commentVisible:!0,allowRescale:!1,autosize:!1,widescreen:!1}),createPopup:function(e,t){if(i.hasPopup===!0)return!1;var a=l("div",{className:"ABP-Popup"},[l("text",e)]);return a.remove=function(){a.isRemoved||(a.isRemoved=!0,i.removeChild(a),i.hasPopup=!1)},i.appendChild(a),i.hasPopup=!0,"number"==typeof t&&setTimeout(function(){a.remove()},t),a},removePopup:function(){for(var e=i.getElementsByClassName("ABP-Popup"),t=0;t<e.length;t++)null!=e[t].remove?e[t].remove():e[t].parentNode.removeChild(e[t]);i.hasPopup=!1},loadCommentList:function(e,i){i="asc"==i?-1:1;var a=Object.keys(s.commentList).sort(function(t,a){return s.commentList[t][e]<s.commentList[a][e]?i:s.commentList[t][e]>s.commentList[a][e]?-i:0});s.commentObjArray=[];for(S in a){var o=a[S],n=s.commentList[o];if(n&&n.time){var r=l("li",{}),c=l("span",{className:"cmt-time"},[l("text",m(n.time/1e3))]),u=l("span",{className:"cmt-content"},[l("text",n.content)]),v=l("span",{className:"cmt-date"},[l("text",d(n.date,!0))]);p(u,!1,36),p(v,!1,18),u.tooltip(n.content),v.tooltip(d(n.date)),r.appendChild(c),r.appendChild(u),r.appendChild(v),r.data=n,r.originalData=danmaku,8==n.mode?r.style.background="#ffe100":0!=n.pool&&(r.style.background="#20ff20"),r[t]("dblclick",function(){s.video.currentTime=this.data.time/1e3,Ze(y.currentTime)}),s.commentObjArray.push(r)}}s.commentListContainer.style.height=24*s.commentObjArray.length+"px",s.renderCommentList(),s.playerUnit.querySelector(".ABP-Comment-List-Count span#danmaku").innerHTML=s.commentObjArray.length},renderCommentList:function(){},commentCallback:function(e){e.result?(s.commentList[e.id]=s.commentList[e.tmp_id],delete s.commentList[e.tmp_id]):(delete s.commentList[e.tmp_id],s.createPopup(e.error,5e3))},swapVideo:null};if(s.swapVideo=function(e){var a=function(){if(!Ye){Ze(e.currentTime);try{var t=b(this),i=this.duration,a=t.end/i*100;s.barLoad.style.width=a+"%"}catch(e){return}}};e[t]("timeupdate",a);var o=0,n=!1,l=!1,r=!1,c=function(){r=!1,e.removeEventListener("canplay",c),e.paused&&s.btnPlay.click(),void 0!=s.lastTime&&(e.currentTime=s.lastTime,delete s.lastTime),void 0!=s.lastSpeed&&(e.playbackRate=s.lastSpeed,delete s.lastSpeed)},d=function(){var t=e.readyState,i=document.getElementById("info-box");if(!e.ended)switch(t){case 1:isMobile()&&e.paused&&(s.createPopup("请点击播放器开始播放",3e3),s.video.dispatchEvent(new Event("autoPlayFailed")));case 2:0==i.style.opacity&&(i.style.opacity=1),dots.running||dots.runTimer();try{var a=b(e);i.childNodes[0].childNodes[0].innerHTML=ABP.Strings.buffering+" "+Math.floor(100*a.delta)/100+"s"}catch(e){i.childNodes[0].childNodes[0].innerHTML=ABP.Strings.buffering}break;case 3:case 4:1==i.style.opacity&&(i.style.opacity=0,dots.stopTimer())}},m=function(){if(window.cid&&!n&&!l&&!r){var t=JSON.parse(localStorage.playHistory||"{}");t[cid]=0|e.currentTime,localStorage.playHistory=JSON.stringify(t)}},u=function(){if(window.cid){var e=JSON.parse(localStorage.playHistory||"{}");e[cid]&&delete e[cid],localStorage.playHistory=JSON.stringify(e)}};e[t]("autoplay",function(){e[t]("canplay",c)}),e[t]("pause",m),e[t]("ended",function(){n=!0,u()});try{var p=JSON.parse(localStorage.playHistory||"{}");void 0!=p[cid]&&(s.lastTime=p[cid])}catch(e){}window[t]("beforeunload",function(){return m(),null}),s.playerUnit[t]("beforecidchange",function(){m(),r=!0,n=!1}),e[t]("loop",function(){l=e.loop}),e[t]("canplay",c),e[t]("canplay",d),e[t]("waiting",d),e[t]("progress",d),e[t]("ended",function(){s.btnPlay.className="button ABP-Play icon-play",s.videoDiv.className="ABP-Video",window.parent!=window&&parent.h5NextPart&&parent.h5NextPart()}),e[t]("progress",a),e.isBound=!0;var f=0;if(s.cmManager){s.cmManager.setBounds=function(){i.offsetHeight<=300||i.offsetWidth<=700?v(i,"ABP-Mini"):g(i,"ABP-Mini");{var e=s.videoDiv.offsetWidth,t=s.videoDiv.offsetHeight;s.proportionalScale?t/493*s.commentScale:s.commentScale}this.width=e,this.height=t,this.options.global.scale=this.width/680/s.commentSpeed,this.dispatchEvent("resize");for(var a in this.csa)this.csa[a].setBounds(this.width,this.height);this.stage.style.width=this.width+"px",this.stage.style.height=this.height+"px",this.stage.style.perspective=this.width*Math.tan(40*Math.PI/180)/2+"px",this.stage.style.webkitPerspective=this.width*Math.tan(40*Math.PI/180)/2+"px",i.querySelector(".BiliPlus-Scale-Menu .Video-Scale div.on").click(),this.canvasResize()},s.cmManager.setBounds(),s.cmManager.clear(),e[t]("progress",function(){f==e.currentTime&&h&&(new Date).getTime()-o>=100?(e.hasStalled=!0,s.cmManager.stopTimer(),s.cmManager.pauseComment()):f!=e.currentTime&&(f=e.currentTime),o=(new Date).getTime()}),window&&window[t]("resize",function(){s.cmManager.setBounds()}),e[t]("timeupdate",function(){s.cmManager.display!==!1&&(e.hasStalled&&(s.cmManager.startTimer(),s.cmManager.resumeComment(),e.hasStalled=!1),s.cmManager.time(Math.floor(1e3*e.currentTime)))}),e[t]("play",function(){s.cmManager.startTimer(),s.cmManager.resumeComment(),s.btnPlay.className="button ABP-Play ABP-Pause icon-pause",s.btnPlay.tooltip(ABP.Strings.pause),v(s.videoDiv,"ABP-HideCursor")}),e[t]("ratechange",function(){0!==e.playbackRate&&rt(s.video.playbackRate)});var h=!1;e[t]("pause",function(){s.cmManager.stopTimer(),s.cmManager.pauseComment(),s.btnPlay.className="button ABP-Play icon-play",s.btnPlay.tooltip(ABP.Strings.play),h=!1,g(s.videoDiv,"ABP-HideCursor")}),e[t]("waiting",function(){s.cmManager.stopTimer(),s.cmManager.pauseComment(),h=!1}),e[t]("playing",function(){s.cmManager.startTimer(),s.cmManager.resumeComment(),h=!0})}},null!==i&&null!==i.getElementsByClassName){s.defaults.w=i.offsetWidth,s.defaults.h=i.offsetHeight;var c=i.getElementsByClassName("ABP-Video");if(!(c.length<=0)){var y=null;s.videoDiv=c[0];for(var S in c[0].children)if(null!=c[0].children[S].tagName&&"VIDEO"===c[0].children[S].tagName.toUpperCase()){y=c[0].children[S];break}var k=c[0].getElementsByClassName("ABP-Container");if(k.length>0&&(s.divComment=k[0]),null!==y){s.video=y,s.video.seek=function(e){this.currentTime=parseFloat(e)/1e3};var B=i.getElementsByClassName("ABP-Play");if(!(B.length<=0)){s.btnPlay=B[0],s.btnPlay.tooltip(ABP.Strings.play),p(s.btnPlay);var P=i.getElementsByClassName("progress-bar");if(!(P.length<=0)){var C=P[0].getElementsByClassName("bar");s.barTimeHitArea=C[0],s.barLoad=C[0].getElementsByClassName("load")[0],s.barTime=C[0].getElementsByClassName("dark")[0];var A=i.getElementsByClassName("time-label");if(!(A.length<=0)){s.timeLabel=A[0];var N=i.getElementsByClassName("ABP-Volume");if(!(N.length<=0)){s.btnVolume=N[0],s.btnVolume.tooltip(ABP.Strings.mute),p(s.btnVolume);var x=i.getElementsByClassName("volume-bar");if(!(x.length<=0)){var w=x[0].getElementsByClassName("bar");s.barVolumeHitArea=w[0],s.barVolume=w[0].getElementsByClassName("load")[0];var T=i.getElementsByClassName("opacity-bar");if(!(T.length<=0)){var T=T[0].getElementsByClassName("bar");s.barOpacityHitArea=T[0],s.barOpacity=T[0].getElementsByClassName("load")[0];var M=i.getElementsByClassName("scale-bar");if(!(M.length<=0)){var M=M[0].getElementsByClassName("bar");s.barScaleHitArea=M[0],s.barScale=M[0].getElementsByClassName("load")[0];var _=i.getElementsByClassName("speed-bar");if(!(_.length<=0)){var _=_[0].getElementsByClassName("bar");s.barSpeedHitArea=_[0],s.barSpeed=_[0].getElementsByClassName("load")[0];var H=i.getElementsByClassName("playSpeed-bar");if(!(H.length<=0)){var H=H[0].getElementsByClassName("bar");s.barPlaySpeedHitArea=H[0],s.barPlaySpeed=H[0].getElementsByClassName("load")[0],i.querySelector(".play-speed-reset")[t]("click",function(){s.video.playbackRate=1});var F=i.getElementsByClassName("prop-checkbox");if(!(F.length<=0)){s.btnAutoOpacity=F[1],s.btnAutoOpacity.tooltip(ABP.Strings.autoOpacityOff),p(s.btnAutoOpacity),s.btnProp=F[0],s.btnProp.tooltip(ABP.Strings.usingCanvas),p(s.btnProp);var L=i.getElementsByClassName("ABP-FullScreen");if(!(L.length<=0)){s.btnFull=L[0],s.btnFull.tooltip(ABP.Strings.fullScreen),p(s.btnFull);var D=i.getElementsByClassName("ABP-Web-FullScreen");if(!(D.length<=0)){s.btnWebFull=D[0],s.btnWebFull.tooltip(ABP.Strings.webFull),p(s.btnWebFull);var E=i.getElementsByClassName("ABP-WideScreen");if(!(E.length<=0)){s.btnWide=E[0],s.btnWide.tooltip(ABP.Strings.wideScreen),p(s.btnWide);var I=i.getElementsByClassName("ABP-Comment-Font");if(!(I.length<=0)){s.btnFont=I[0],s.btnFont.tooltip(ABP.Strings.sendStyle),p(s.btnFont);var O=i.getElementsByClassName("ABP-Comment-Color");if(!(O.length<=0)){s.btnColor=O[0],s.btnColor.tooltip(ABP.Strings.sendColor),p(s.btnColor);var z=i.getElementsByClassName("ABP-Comment-Color-Display");if(!(z.length<=0)){s.displayColor=z[0];var V=i.getElementsByClassName("ABP-Comment-Input");if(!(V.length<=0)){s.txtText=V[0];var W=i.getElementsByClassName("ABP-Comment-List-Container-Inner");if(!(W.length<=0)){s.commentListContainer=W[0];var R=i.getElementsByClassName("ABP-Comment-Send");if(!(R.length<=0)){s.btnSend=R[0],s.btnSend.tooltip(ABP.Strings.sendTooltip),p(s.btnSend);var q=i.getElementsByClassName("ABP-Control");q.length>0&&(s.controlBar=q[0]);var j=i.getElementsByClassName("ABP-CommentShow");if(!(j.length<=0)){s.btnDm=j[0],s.btnDm.tooltip(ABP.Strings.hideComment),p(s.btnDm);var U=i.getElementsByClassName("ABP-Loop");if(!(U.length<=0)){s.btnLoop=U[0],s.btnLoop.tooltip(ABP.Strings.loopOff),p(s.btnLoop);var X={videoDimension:!0,gecko:!0,webkit:!0,videoQuality:!0,flvjs:!0},J=function(e){return document.querySelector(e)},Y=function(e){return(1*e).toFixed(2)},Q=">:last-child",G=J("#player-dimension"+Q),K=J("#video-dimension"+Q),Z=J("#canvas-fps"+Q),$=J("#buffer-health-column"),ee=J("#realtime-bitrate-column"),te=J("#download-speed-column"),ie=[],ae=[],oe=[],ne=J("#buffer-health"+Q),le='<svg style="width:180px;height:21px"><polyline style="fill:transparent;stroke:#ccc"></polyline><polyline points="1,21 180,21 180,1" style="fill:transparent;stroke:#fff"></polyline></svg>',se="",re=document.createElement("style"),ce=document.createElement("style"),de=document.querySelectorAll(".flvjs>:last-child"),S=0,me=function(e,t){var i,a=0,o=[];t.forEach(function(e){a=e>a?e:a}),0==a&&(a=1);for(i in t)isNaN(t[i])&&(t[i]=0),o.push(3*i+","+(20*(1-t[i]/a)+1)+" "+(3*i+3)+","+(20*(1-t[i]/a)+1));e.setAttribute("points",o.join(" "))},ue=!1,pe=J("#Player-Stats-Toggle"),ve=function(e){"stats-close"==e.target.id&&e.stopPropagation(),J(".Player-Stats").style.display=ue?"":"block",ue=!ue},fe=-1,ge=0;for(pe[t]("click",ve),J("#stats-close")[t]("click",ve);60>S;S++)ie.push(0),ae.push(0),oe.push(0);if($.innerHTML=le,$=$.querySelector("polyline"),ee.innerHTML=le,ee=ee.querySelector("polyline"),te.innerHTML=le,te=te.querySelector("polyline"),void 0==y.videoWidth&&(X.videoDimension=!1,se+="#video-dimension{display:none}"),void 0==y.mozDecodedFrames&&(X.gecko=!1,se+=".gecko{display:none}"),void 0==y.webkitDecodedFrameCount&&(X.webkit=!1,se+=".webkit{display:none}"),void 0==y.getVideoPlaybackQuality&&(X.videoQuality=!1,se+=".videoQuality{display:none}"),re.innerHTML=se,document.head.appendChild(re),ce.innerHTML=".flvjs{display:none}",document.head.appendChild(ce),void 0==window.flvplayer&&(X.flvjs=!1),
setInterval(function(){ge^=1,G.innerHTML=y.offsetWidth+"x"+y.offsetHeight+" *"+devicePixelRatio,X.videoDimension&&(K.innerHTML=y.videoWidth+"x"+y.videoHeight);var e={};try{e=b(y)}catch(e){}if(e=e.delta||0,ie.push(e),ie.shift(),ne.innerHTML=Y(e)+"s",ue&&me($,ie),ue){for(var t,i,a=y.buffered,o=J("#buffer-clips>span"),n=y.duration==1/0?a.end(a.length-1):y.duration,r=[],c=0;c<a.length;c++)c>=o.childNodes.length&&o.appendChild(l("span",{className:"buffer-clip"})),t=a.start(c),i=a.end(c)-t,o.childNodes[c].style.left=Y(t/n*100)+"%",o.childNodes[c].style.width=Y(i/n*100)+"%",r.push(m(0|t)+" - "+m(t+i|0));for(;c<o.childNodes.length;)o.childNodes[c].remove();o.parentNode.parentNode.childNodes[2].innerHTML=r.join("\n"),J("#buffer-clips>span>div").style.left=Y(y.currentTime/n*100)+"%"}if(X.flvjs)if(flvplayer._mediaInfo){ce.innerHTML="";var d,u,c=0,p=flvplayer._mediaInfo,v=flvplayer.statisticsInfo,f=y.currentTime,g=flvplayer._mediaDataSource.segments,h=0,S=0;for(u=0;u<g.length;u++){if(f<=(h+g[u].duration)/1e3){h=f-h/1e3|0;break}h+=g[u].duration,S++}u>=g.length&&(u=g.length-1);var k=g[u].filesize,B=g[u].duration;J("#mimeType>:last-child").innerHTML=p.mimeType,de[c++].innerHTML=Y(p.fps),de[c++].innerHTML=Y(p.videoDataRate)+" kbps",de[c++].innerHTML=Y(p.audioDataRate)+" kbps",de[c++].innerHTML=Y(k/B*8)+" kbps",p.bitrateMap?(p.bitrateMap[S]&&(d=p.bitrateMap[S][h]),void 0!=d?ge&&fe!=(0|y.currentTime)?(fe=0|y.currentTime,de[c++].innerHTML=Y(d)+" kbps",ae.push(d),ae.shift(),ue&&me(ee,ae)):c++:de[c++].innerHTML="N/A"):de[c++].innerHTML="N/A",ge&&(oe.push(v.speed),oe.shift(),ue&&me(te,oe),de[c++].innerHTML=Y(v.speed)+" KB/s",flvplayer._statisticsInfo.speed=0)}else ce.innerHTML=".flvjs{display:none}",J("#mimeType>:last-child").innerHTML="video/mp4";if(window.overallBitrate?(J("#overall-bitrate").parentNode.style.display="",J("#overall-bitrate").innerHTML=Y(overallBitrate)+" kbps"):J("#overall-bitrate").parentNode.style.display="none",ge&&(Z.innerHTML=s.cmManager.canvasFPS),X.gecko&&["mozParsedFrames","mozDecodedFrames","mozPaintedFrames"].forEach(function(e){J("#"+e).innerHTML=y[e]}),X.webkit&&["webkitDecodedFrameCount","webkitDroppedFrameCount"].forEach(function(e){J("#"+e).innerHTML=y[e]}),X.videoQuality){var P=y.getVideoPlaybackQuality();J("#totalVideoFrames").innerHTML=P.totalVideoFrames,J("#droppedVideoFrames").innerHTML=P.droppedVideoFrames}},500),"undefined"!=typeof CommentManager&&(s.cmManager=new CommentManager(s.divComment),s.cmManager.display=!0,s.cmManager.init(),s.cmManager.clear(),s.cmManager.filter.addModifier(shield.filter),window&&window[t]("resize",function(){s.cmManager.setBounds()})),"object"==typeof ABP.playerConfig&&(ABP.playerConfig.volume&&(s.video.volume=ABP.playerConfig.volume),ABP.playerConfig.opacity&&(s.cmManager.options.global.opacity=ABP.playerConfig.opacity)),e(".ABP-Comment-List-Title *").click(function(){var t=e(this).attr("item"),i=e(this).hasClass("asc")?"desc":"asc";e(".ABP-Comment-List-Title *").removeClass("asc").removeClass("desc"),e(this).addClass(i),s.loadCommentList(t,i)}),e(".ABP-Unit .ABP-CommentStyle .ABP-Comment-FontOption .style-option").click(function(){e(this).closest(".style-select").find(".style-option").removeClass("on"),e(this).addClass("on"),s[e(this).closest(".style-select").attr("name")]=parseInt(e(this).attr("value"))}),e(i).find(".ABP-Comment-ColorPicker").colpick({flat:!0,submit:0,color:"ffffff",onChange:function(e,t){s.commentColor=t,s.displayColor.style.backgroundColor="#"+t}}),y.isBound!==!0){s.swapVideo(y),s.playerUnit.querySelector(".BiliPlus-Scale-Menu .Video-Defination")[t]("click",function(e){if(!e.target.hasAttribute("changeto"))return!1;var t=JSON.parse(e.target.getAttribute("changeto"));changeSrc({target:{value:t[1]}},t[0]),g(e.target.parentNode.querySelector(".on"),"on"),v(e.target,"on")}),s.playerUnit.querySelector(".BiliPlus-Scale-Menu .Video-Scale")[t]("click",function(e){if(!e.target.hasAttribute("changeto"))return!1;switch(e.target.getAttribute("changeto")){case"default":f(s.video,"scale")&&g(s.video,"scale"),s.video.style.width="",s.video.style.height="",s.video.style.paddingTop="",s.video.style.paddingLeft="";break;case"16_9":v(s.video,"scale");var t=s.videoDiv.offsetWidth,i=s.videoDiv.offsetHeight,a="",o="";i/9*16>t?(a=(i-t/16*9)/2+"px",i=t/16*9/i*100+"%",t="100%"):(o=(t-i/9*16)/2+"px",t=i/9*16/t*100+"%",i="100%"),s.video.style.width=t,s.video.style.height=i,s.video.style.paddingTop=a,s.video.style.paddingLeft=o;break;case"4_3":v(s.video,"scale");var t=s.videoDiv.offsetWidth,i=s.videoDiv.offsetHeight,a="",o="";i/3*4>t?(a=(i-t/4*3)/2+"px",i=t/4*3/i*100+"%",t="100%"):(o=(t-i/3*4)/2+"px",t=i/3*4/t*100+"%",i="100%"),s.video.style.width=t,s.video.style.height=i,s.video.style.paddingTop=a,s.video.style.paddingLeft=o;break;case"full":v(s.video,"scale"),s.video.style.width="",s.video.style.height="",s.video.style.paddingTop="",s.video.style.paddingLeft=""}g(e.target.parentNode.querySelector(".on"),"on"),v(e.target,"on")});var he=!1;y[t]("autoPlayFailed",function(){he=!0});var be,ye=0,Se=function(e){var t=Date.now();500>=t-ye?(s.btnFull.click(),200>=t-ye?clearTimeout(be):s.btnPlay.click()):he?(s.btnPlay.click(),he=!1):be=setTimeout(function(){s.btnPlay.click()},250),ye=t,e.preventDefault()};s.videoDiv[t]("click",Se),s.playerUnit.querySelector(".ABP-Bottom-Extend")[t]("click",function(e){e.preventDefault(),e.stopPropagation(),Se(e)});var ke=setTimeout(function(){v(s.videoDiv,"ABP-HideCursor")},3e3);s.videoDiv[t]("mousemove",function(e){o(e)||ke&&clearTimeout(ke),f(s.videoDiv,"ABP-HideCursor")&&g(s.videoDiv,"ABP-HideCursor"),ke=setTimeout(function(){v(s.videoDiv,"ABP-HideCursor")},3e3)}),s.btnVolume[t]("click",function(){if(0==s.video.muted){if(s.video.muted=!0,0==s.video.muted)return void this.tooltip(ABP.Strings.muteNotSupported);this.className="button ABP-Volume icon-volume-mute2",this.tooltip(ABP.Strings.unmute),s.barVolume.style.width="0%"}else s.video.muted=!1,this.className="button ABP-Volume icon-volume-",this.className+=s.video.volume<.1?"mute":s.video.volume<.33?"low":s.video.volume<.67?"medium":"high",this.tooltip(ABP.Strings.mute),s.barVolume.style.width=100*s.video.volume+"%"}),s.btnWebFull[t]("click",function(){s.state.fullscreen=f(i,"ABP-FullScreen"),v(i,"ABP-FullScreen"),s.btnFull.className="button ABP-FullScreen icon-screen-normal",s.btnFull.tooltip(ABP.Strings.exitWebFull),s.state.fullscreen=!0,s.cmManager&&s.cmManager.setBounds(),s.state.allowRescale&&(s.state.fullscreen?s.defaults.w>0&&(s.cmManager.options.scrollScale=i.offsetWidth/s.defaults.w):s.cmManager.options.scrollScale=1)});var Be=!1,Pe=!1;s.btnFont[t]("click",function(){Pe&&s.btnColor.click(),this.parentNode.classList.toggle("on"),Be=!Be}),s.btnColor[t]("click",function(){Be&&s.btnFont.click(),this.parentNode.classList.toggle("on"),Pe=!Pe});var Ce=function(){localStorage.YHP_PlayerSettings=JSON.stringify({volume:s.video.volume,opacity:s.cmManager.options.global.opacity,scale:s.commentScale,speed:s.commentSpeed,commentVisible:s.cmManager.display,useCSS:s.cmManager.options.global.useCSS,autoOpacity:s.cmManager.options.global.autoOpacity})};s.btnAutoOpacity[t]("click",function(){this.classList.toggle("on");var e=this.classList.contains("on");s.cmManager.autoOpacity(e),this.tooltip(e?ABP.Strings.autoOpacityOn:ABP.Strings.autoOpacityOff),Ce()}),ABP.playerConfig.autoOpacity&&s.btnAutoOpacity.click(),s.btnProp[t]("click",function(){this.classList.toggle("on");var e=this.classList.contains("on");s.cmManager.useCSS(e),this.tooltip(e?ABP.Strings.usingCSS:ABP.Strings.usingCanvas),Ce()}),ABP.playerConfig.useCSS&&s.btnProp.click();var Ae=function(){!document.isFullScreen()&&f(i,"ABP-FullScreen")&&(g(i,"ABP-FullScreen"),s.btnFull.className="button ABP-FullScreen icon-screen-full",s.btnFull.tooltip(ABP.Strings.fullScreen),s.state.fullscreen=!!document.isFullScreen())};document[t]("fullscreenchange",Ae,!1),document[t]("webkitfullscreenchange",Ae,!1),document[t]("mozfullscreenchange",Ae,!1),document[t]("MSFullscreenChange",Ae,!1),s.btnFull[t]("click",function(){s.state.fullscreen=f(i,"ABP-FullScreen"),s.state.fullscreen?(g(i,"ABP-FullScreen"),this.className="button ABP-FullScreen icon-screen-full",this.tooltip(ABP.Strings.fullScreen),document.exitFullscreen()):(v(i,"ABP-FullScreen"),this.className="button ABP-FullScreen icon-screen-normal",this.tooltip(ABP.Strings.exitFullScreen),i.requestFullScreen()),s.state.fullscreen=!s.state.fullscreen,s.cmManager&&s.cmManager.setBounds(),s.state.allowRescale&&(s.state.fullscreen?s.defaults.w>0&&(s.cmManager.options.scrollScale=i.offsetWidth/s.defaults.w):s.cmManager.options.scrollScale=1)}),s.btnWide[t]("click",function(){s.state.widescreen=f(i,"ABP-WideScreen"),s.state.widescreen?(g(i,"ABP-WideScreen"),this.className="button ABP-WideScreen icon-tv",i.dispatchEvent(new Event("normal")),this.tooltip(ABP.Strings.wideScreen)):(v(i,"ABP-WideScreen"),this.className="button ABP-WideScreen icon-tv on",i.dispatchEvent(new Event("wide")),this.tooltip(ABP.Strings.exitWideScreen)),s.state.widescreen=!s.state.widescreen,s.cmManager&&s.cmManager.setBounds(),s.state.allowRescale&&(s.state.fullscreen?s.defaults.w>0&&(s.cmManager.options.scrollScale=i.offsetWidth/s.defaults.w):s.cmManager.options.scrollScale=1)}),s.btnDm[t]("click",function(){0==s.cmManager.display?(s.cmManager.display=!0,s.cmManager.startTimer(),this.className="button ABP-CommentShow icon-comment on",this.tooltip(ABP.Strings.hideComment)):(s.cmManager.display=!1,s.cmManager.clear(),s.cmManager.stopTimer(),this.className="button ABP-CommentShow icon-comment",this.tooltip(ABP.Strings.showComment)),Ce()}),ABP.playerConfig.commentVisible||s.btnDm.click(),s.btnLoop[t]("click",function(){0==s.video.loop?(s.video.loop=!0,this.className="button ABP-Loop icon-loop on",this.tooltip(ABP.Strings.loopOn)):(s.video.loop=!1,this.className="button ABP-Loop icon-loop",this.tooltip(ABP.Strings.loopOff)),s.video.dispatchEvent(new CustomEvent("loop"))});var Ne,xe,we,Te=s.playerUnit.querySelector(".Context-Menu"),Me=Te.querySelector(".Context-Menu-Background"),_e=Te.querySelector(".Context-Menu-Body"),He=function(e){return Re?(e.preventDefault(),e.stopPropagation(),Re=!1,!1):(Te.style.display="none",void e.preventDefault())},Fe=null,Le=0,De=null,Ee={},Ie=function(){shield.addText(this.getAttribute("data-text"))},Oe=function(){shield.addUser(this.getAttribute("data-mid"))},ze=function(){shield.addColor(this.getAttribute("data-color"))},Ve=function(e,i,a){Te.style.display="block";var o,n,r,c,d,m=_e.querySelectorAll(".dm"),u=s.playerUnit.getBoundingClientRect();for(S=m.length-2;S>=0;S--)"dm static"!=m[S].className&&m[S].remove();for(o=_e.firstChild,S=0;S<a.length;S++){for(n=a[S].originalData,r=n.color.toString(16);r.length<6;)r="0"+r;if(c=16777215==n.color,d=l("div",{className:"dm"},[l("div",{className:"content"},[l("text",n.text)]),l("div",{className:"dmMenu"},[l("div",{"data-content":n.text},[l("text",ABP.Strings.copyComment)]),l("div",{"data-text":n.text},[l("text",ABP.Strings.blockContent+"“"+n.text+"”")]),l("div",{"data-mid":n.hash},[l("text",ABP.Strings.blockUser+""+n.hash)]),l("div",c?{}:{"data-color":r},[l("text",c?ABP.Strings.blockColorWhite:ABP.Strings.blockColor+""),l("div",{className:"color",style:{background:"#"+r}})])])]),n.mode>6){d.childNodes[0].innerHTML="特殊弹幕";var p=d.childNodes[1];p.childNodes[0].style.display="none",p.childNodes[2].style.display="none",p.childNodes[4].style.display="none"}_e.insertBefore(d,o)}var v=_e.querySelectorAll(".dmMenu");for(S=0;S<v.length-1;S++)v[S].childNodes[0][t]("click",function(){try{var e=document.createElement("input");e.style.width=0,e.style.height=0,document.body.appendChild(e),e.value=this.getAttribute("data-content"),e.select();var t=document.execCommand("copy");if(document.body.removeChild(e),!t)throw""}catch(e){s.createPopup(ABP.Strings.copyFail,3e3)}}),v[S].childNodes[1][t]("click",Ie),v[S].childNodes[2][t]("click",Oe),v[S].childNodes[3][t]("click",ze);e-=u.left,i-=u.top,u.width-e<300&&(e=u.width-300),u.height-_e.offsetHeight-i<0&&(i=u.height-_e.offsetHeight);var f=_e.querySelector(".dm:nth-last-of-type(2)>.dmMenu");if(null!=f){f.style.display="block";var g=f.getBoundingClientRect();f.style.display="",u.top+u.height-g.height-i<0&&(i=u.height-g.height)}_e.style.left=e+"px",_e.style.top=i+"px"},We=null,Re=!1,qe=!1,je=!1,Ue=!1,Xe=null;_e.querySelector("#Player-Speed-Control .dmMenu")[t]("click",function(e){var t=e.target.getAttribute("data-speed");void 0!=t&&(s.video.playbackRate=t)}),_e[t]("senderInfoFetched",function(e){var i=e.detail;if(i.mid==Le&&null!=De){var a=De.parentNode.getBoundingClientRect(),o=a.left-150,n=innerHeight-a.bottom,s=l("div",{className:"Context-Menu-Body",id:"Sender-Info",style:{left:o+"px",bottom:n+"px",position:"fixed",fontFamily:"-apple-system,Arial,'PingFang SC','STHeiti Light','Hiragino Kaku Gothic ProN','Microsoft YaHei'",textAlign:"center"}},[l("div",{},[l("img",{style:{height:"130px",width:"130px"},src:i.face.replace(/http\:/,"")})]),l("div",{},[l("text",i.name)]),l("div",{},[l("text",i.mid)]),l("div",{},[l("text","LV"+i.level_info.current_level)])]);document.body.appendChild(s),n+s.offsetHeight>innerHeight&&(s.style.bottom="",s.style.top=a.top+"px"),s[t]("click",function(){window.open("/space/"+i.mid+"/"),document.body.removeChild(s)}),s[t]("mouseenter",function(){clearTimeout(Fe)}),s[t]("mouseleave",function(){clearTimeout(Fe),Fe=setTimeout(function(){document.body.removeChild(document.getElementById("Sender-Info"))},500)})}}),window.getSenderInfo=function(e){0==e.code&&(Ee[Le]=e.card,_e.dispatchEvent(new CustomEvent("senderInfoFetched",{detail:e.card})))},Te[t]("click",He),Me[t]("contextmenu",He),s.videoDiv.parentNode[t]("contextmenu",function(e){e.preventDefault(),e.stopPropagation();var t=s.divComment.getBoundingClientRect(),i=e.clientX,a=e.clientY;Ve(i,a,s.cmManager.getCommentFromPoint(i-t.left,a-t.top))}),s.commentListContainer[t]("contextmenu",function(e){var t=e.target.parentNode.data;return void 0==t?!1:(e.preventDefault(),e.stopPropagation(),void Ve(e.clientX,e.clientY,[t]))}),s.videoDiv.parentNode[t]("touchstart",function(e){if(qe=!1,je=!1,we=s.video.currentTime,Re=!1,e.touches.length>1&&null!=We)return clearTimeout(We),void(We=null);var t=s.divComment.getBoundingClientRect(),i=e.touches[0].clientX,a=e.touches[0].clientY,o=s.cmManager.getCommentFromPoint(i-t.left,a-t.top);Ne=i,xe=a,We=setTimeout(function(){je=!0,We=null,Re=!0,Ve(i,a,o)},300)}),s.playerUnit.querySelector(".shield").addEventListener("touchstart touchmove touchend",function(e){e.stopPropagation()}),s.videoDiv.parentNode[t]("touchmove",function(e){null!=We&&(clearTimeout(We),We=null);var t=e.touches[0].clientX,i=e.touches[0].clientY,a=t-Ne,o=i-xe,n=s.videoDiv.getBoundingClientRect(),l=(n.width,n.height);if(qe){var r=0,c=a>0?1:0,d=["Low","Med","High"],u=s.video.duration;l/3>i?we+=.2*a:2*l/3>i?(we+=.6*a,r=1):(we+=1.5*a,r=2),we=0>we?0:we>u?u:we,Ne+=a,Ne-n.left<50||n.right-Ne<50?(document.querySelector(".Drag-Icon").className="Drag-Icon cancel",J(".Drag-Speed").innerHTML=ABP.Strings.dragControlCancel,J(".Drag-Time").innerHTML="　",Ue=!0):(document.querySelector(".Drag-Icon").className="Drag-Icon "+(c?"forward":"rewind"),J(".Drag-Speed").innerHTML=ABP.Strings["dragControl"+d[r]+(c?"Inc":"Dec")],J(".Drag-Time").innerHTML=m(we)+"╱"+m(u),Ue=!1,u>0&&(document.querySelector(".Drag-Time-Bar .fill").style.width=we/u*100+"%"))}else je||(-10>a||a>10?(qe=!0,null!=Xe&&(clearTimeout(Xe),Xe=null),J(".Drag-Control").style.display="block"):(-10>o||o>10)&&(je=!0))}),s.videoDiv.parentNode[t]("touchend",function(){null!=We&&(clearTimeout(We),We=null),qe&&!Ue&&(s.video.currentTime=we),Xe=setTimeout(function(){J(".Drag-Control").style.display="none"},1e3)}),_e[t]("touchstart",function(e){var t=_e.getBoundingClientRect();e.touches[0].clientX-t.left<=t.width&&e.touches[0].clientY-t.top<=t.height&&(Re=!0)});var Je=function(){var e=new Date,t=""+e.getTime()+Math.random();return""==s.txtText.value||s.txtText.disabled?!1:(s.playerUnit.dispatchEvent(new CustomEvent("sendcomment",{detail:{id:t,message:s.txtText.value,fontsize:s.commentFontSize,color:parseInt("0x"+s.commentColor),date:e.getFullYear()+"-"+r(e.getMonth())+"-"+r(e.getDay())+" "+r(e.getHours())+":"+r(e.getMinutes())+":"+r(e.getSeconds()),playTime:s.video.currentTime,mode:s.commentMode,pool:0}})),s.cmManager.send({text:s.txtText.value,mode:s.commentMode,stime:s.video.currentTime,size:s.commentFontSize,color:parseInt("0x"+s.commentColor),border:!0}),s.commentList[t]={date:parseInt(e.getTime()/1e3),time:1e3*s.video.currentTime,mode:s.commentMode,user:"-",pool:0,content:s.txtText.value},s.txtText.value="",s.txtText.disabled=!0,void setTimeout(function(){s.txtText.disabled=!1},s.commentCoolDown))};s.txtText.parentNode[t]("submit",function(e){return e.preventDefault(),Je(),!1}),s.btnSend[t]("click",Je),s.timeLabel[t]("click",function(){s.timeJump=l("input",{className:"time-jump"}),s.timeJump.value=m(s.video.currentTime),s.controlBar.appendChild(s.timeJump),s.timeJump[t]("blur",function(){s.timeJump&&s.timeJump.parentNode.removeChild(s.timeJump),s.timeJump=null}),s.timeJump[t]("keydown",function(e){if(13==e.keyCode){var t=u(s.timeJump.value);t&&t<=s.video.duration&&(s.video.currentTime=t,s.video.paused&&s.btnPlay.click()),s.timeJump.parentNode.removeChild(s.timeJump)}else(e.keyCode<48||e.keyCode>59)&&(e.keyCode<96||e.keyCode>105)&&8!=e.keyCode&&16!=e.keyCode&&37!=e.keyCode&&39!=e.keyCode&&46!=e.keyCode&&e.preventDefault()}),s.timeJump.focus(),s.timeJump.select()}),s.barTime.style.width="0%";var Ye=!1;s.barTimeHitArea[t]("mousedown",function(){Ye=!0});var Qe={imgs:[],data:[],len:[0,0],size:[0,0]},Ge=function(e){if(0!=e.code)return!1;Qe.imgs=JSON.parse(JSON.stringify(e.data.image).replace(/http:/g,"https:")),Qe.len=[e.data.img_x_len,e.data.img_y_len],Qe.size=[e.data.img_x_size,e.data.img_y_size];for(var t=0,i=[];t<100*Qe.imgs.length;t++)i.push(t*e.data.step);Qe.data=i},Ke=!1;s.barTimeHitArea[t]("mouseenter",function(){Ke=!0}),s.barTimeHitArea[t]("mouseleave",function(){Ke=!1}),s.playerUnit[t]("previewData",function(e){Ge(e.detail)}),document[t]("mouseup",function(e){if(Ye){var t=(e.clientX-s.barTimeHitArea.getBoundingClientRect().left)/s.barTimeHitArea.offsetWidth*s.video.duration;0>t&&(t=0),Math.abs(t-s.video.currentTime)>4&&s.cmManager&&s.cmManager.clear(),s.video.currentTime=t}Ye=!1});var Ze=function(e){s.barTime.style.width=e/y.duration*100+"%",s.timeLabel.innerHTML=m(e)+" / "+m(y.duration)};document[t]("mousemove",function(e){var t=(e.clientX-s.barTimeHitArea.getBoundingClientRect().left)/s.barTimeHitArea.offsetWidth*s.video.duration;if(0>t&&(t=0),t>s.video.duration&&(t=s.video.duration),Qe.data.length>0&&null!=n("ABP-Tooltip")&&Ke){var i;for(i=0;i<Qe.data.length;i++)if(t<Qe.data[i]){i--;break}var a=Math.floor(i/100),o=Math.floor(i%100/10),r=i%10,c=n("preview-container"),d=n("ABP-Tooltip");null==c&&(c=l("div",{id:"preview-container",style:{position:"absolute","background-size":Qe.size[0]+"px "+Qe.size[1]+"px",width:Qe.size[0]+"px",height:Qe.size[1]+"px",background:"rgba(0,0,0,0)",display:"none"}}),d.parentNode.insertBefore(c,d)),c.style.left=d.offsetLeft+(d.offsetWidth-Qe.size[0])/2+"px",c.style.top=d.offsetTop+(d.offsetHeight-Qe.size[1])+"px",c.style.display="block",c.style.backgroundImage='url("'+Qe.imgs[a]+'")',c.style.backgroundPosition="-"+r*Qe.size[0]+"px -"+o*Qe.size[1]+"px"}null==n("ABP-Tooltip")&&null!=n("preview-container")&&(n("preview-container").style.display="none"),s.barTimeHitArea.tooltip(m(t)),Ye&&Ze(t)}),p(s.barTimeHitArea,!0,-12);var $e=!1;s.barVolumeHitArea[t]("mousedown",function(){$e=!0}),s.barVolume.style.width=100*s.video.volume+"%";var et=function(e){s.barVolume.style.width=100*e+"%",s.video.muted=!1,s.btnVolume.className="button ABP-Volume icon-volume-",s.btnVolume.className+=.1>e?"mute":.33>e?"low":.67>e?"medium":"high",s.btnVolume.tooltip(ABP.Strings.mute),s.barVolumeHitArea.tooltip(parseInt(100*e)+"%"),Ce()};document[t]("mouseup",function(e){if($e){var t=(e.clientX-s.barVolumeHitArea.getBoundingClientRect().left)/s.barVolumeHitArea.offsetWidth;0>t&&(t=0),t>1&&(t=1),s.video.volume=t,et(s.video.volume)}$e=!1}),document[t]("mousemove",function(e){var t=(e.clientX-s.barVolumeHitArea.getBoundingClientRect().left)/s.barVolumeHitArea.offsetWidth;0>t&&(t=0),t>1&&(t=1),$e?(s.video.volume=t,et(s.video.volume)):s.barVolumeHitArea.tooltip(parseInt(100*t)+"%")}),p(s.barVolumeHitArea,!0,-12);var tt=!1;s.barOpacityHitArea[t]("mousedown",function(){tt=!0}),s.barOpacity.style.width=100*s.cmManager.options.global.opacity+"%";var it=function(e){s.barOpacity.style.width=100*e+"%",s.barOpacityHitArea.tooltip(parseInt(100*e)+"%"),Ce()};document[t]("mouseup",function(e){if(tt){var t=(e.clientX-s.barOpacityHitArea.getBoundingClientRect().left)/s.barOpacityHitArea.offsetWidth;0>t&&(t=0),t>1&&(t=1),s.cmManager.options.global.opacity=t,it(s.cmManager.options.global.opacity),Ce()}tt=!1}),document[t]("mousemove",function(e){var t=(e.clientX-s.barOpacityHitArea.getBoundingClientRect().left)/s.barOpacityHitArea.offsetWidth;0>t&&(t=0),t>1&&(t=1),tt?(s.cmManager.options.global.opacity=t,it(s.cmManager.options.global.opacity)):s.barOpacityHitArea.tooltip(parseInt(100*t)+"%")}),p(s.barOpacityHitArea,!0,-6);var at=!1;s.barScaleHitArea[t]("mousedown",function(){at=!0}),s.barScale.style.width=(s.commentScale-.2)/1.8*100+"%";var ot=function(e){s.barScale.style.width=(e-.2)/1.8*100+"%",s.barScaleHitArea.tooltip(parseInt(100*e)+"%"),s.cmManager.setBounds(),Ce()};document[t]("mouseup",function(e){if(at){var t=.2+1.8*(e.clientX-s.barScaleHitArea.getBoundingClientRect().left)/s.barScaleHitArea.offsetWidth;.2>t&&(t=.2),t>2&&(t=2),s.commentScale=t,ot(s.commentScale),Ce()}at=!1}),document[t]("mousemove",function(e){var t=.2+1.8*(e.clientX-s.barScaleHitArea.getBoundingClientRect().left)/s.barScaleHitArea.offsetWidth;.2>t&&(t=.2),t>2&&(t=2),at?(s.commentScale=t,ot(s.commentScale)):s.barScaleHitArea.tooltip(parseInt(100*t)+"%")}),p(s.barScaleHitArea,!0,-6);var nt=!1;s.barSpeedHitArea[t]("mousedown",function(){nt=!0}),s.barSpeed.style.width=(s.commentSpeed-.5)/1.5*100+"%";var lt=function(e){s.barSpeed.style.width=(e-.5)/1.5*100+"%",s.barSpeedHitArea.tooltip(parseInt(100*e)+"%"),s.cmManager.setBounds(),Ce()};document[t]("mouseup",function(e){if(nt){var t=.5+1.5*(e.clientX-s.barSpeedHitArea.getBoundingClientRect().left)/s.barSpeedHitArea.offsetWidth;.5>t&&(t=.5),t>2&&(t=2),s.commentSpeed=t,lt(s.commentSpeed),Ce()}nt=!1}),document[t]("mousemove",function(e){var t=.5+1.5*(e.clientX-s.barSpeedHitArea.getBoundingClientRect().left)/s.barSpeedHitArea.offsetWidth;.5>t&&(t=.5),t>2&&(t=2),nt?(s.commentSpeed=t,lt(s.commentSpeed)):s.barSpeedHitArea.tooltip(parseInt(100*t)+"%")}),p(s.barSpeedHitArea,!0,-6);var st=!1;s.barPlaySpeedHitArea[t]("mousedown",function(){st=!0}),s.barPlaySpeed.style.width=(s.video.playbackRate-.5)/1.5*100+"%";var rt=function(e){s.barPlaySpeed.style.width=(e-.5)/1.5*100+"%",s.barPlaySpeedHitArea.tooltip(e.toFixed(2)+"x")};document[t]("mouseup",function(e){if(st){var t=.5+1.5*(e.clientX-s.barPlaySpeedHitArea.getBoundingClientRect().left)/s.barPlaySpeedHitArea.offsetWidth;.5>t&&(t=.5),t>2&&(t=2),s.video.playbackRate=t}st=!1}),document[t]("mousemove",function(e){var t=.5+1.5*(e.clientX-s.barPlaySpeedHitArea.getBoundingClientRect().left)/s.barPlaySpeedHitArea.offsetWidth;.5>t&&(t=.5),t>2&&(t=2),st?s.video.playbackRate=t:s.barPlaySpeedHitArea.tooltip(t.toFixed(2)+"x")}),p(s.barPlaySpeedHitArea,!0,-6),s.btnPlay[t]("click",function(){s.video.paused?s.video.play():s.video.pause()}),i[t]("keydown",function(e){if(e&&"INPUT"!=document.activeElement.tagName)switch(-1!=[27,32,37,38,39,40].indexOf(e.keyCode)&&e.preventDefault(),e.keyCode){case 27:abpinst.state.fullscreen&&abpinst.btnFull.click();break;case 32:s.btnPlay.click();break;case 37:var t=s.video.currentTime-=5*s.video.playbackRate;s.cmManager.clear(),0>t&&(t=0),s.video.currentTime=t.toFixed(3),s.video.paused&&s.btnPlay.click(),Ze(y.currentTime),s.barTimeHitArea.tooltip(m(y.currentTime));break;case 39:var t=s.video.currentTime+=5*s.video.playbackRate;s.cmManager.clear(),t>s.video.duration&&(t=s.video.duration),s.video.currentTime=t.toFixed(3),s.video.paused&&s.btnPlay.click(),Ze(y.currentTime),s.barTimeHitArea.tooltip(m(y.currentTime));break;case 38:var i=s.video.volume+.1;i>1&&(i=1),s.video.volume=i.toFixed(3),et(s.video.volume);break;case 40:var i=s.video.volume-.1;0>i&&(i=0),s.video.volume=i.toFixed(3),et(s.video.volume)}}),i[t]("touchmove",function(e){e.preventDefault()});var ct=null;i[t]("touchstart",function(e){f(s.videoDiv,"ABP-HideCursor")&&g(s.videoDiv,"ABP-HideCursor"),e.targetTouches.length>0&&(ct=e.targetTouches[0])}),i[t]("touchend",function(e){if(v(s.videoDiv,"ABP-HideCursor"),e.changedTouches.length>0&&null!=ct){var t=e.changedTouches[0].pageX-ct.pageX,i=e.changedTouches[0].pageY-ct.pageY;if(Math.abs(t)<20&&Math.abs(i)<20)return void(ct=null);Math.abs(t)>3*Math.abs(i)?t>0?s.video.paused&&s.btnPlay.click():s.video.paused||s.btnPlay.click():Math.abs(i)>3*Math.abs(t)&&(s.video.volume=0>i?Math.min(1,s.video.volume+.1):Math.max(0,s.video.volume-.1)),ct=null}}),i[t]("mouseup",function(){if("INPUT"!=document.activeElement.tagName){var e=window.scrollY;s.videoDiv.focus(),window.scrollTo(window.scrollX,e)}})}if("undefined"!=typeof CommentManager&&s.state.autosize){var dt=function(){if(0!==y.videoHeight&&0!==y.videoWidth){var e=y.videoHeight/y.videoWidth,t=i.offsetWidth,a=i.offsetHeight,o=a/t;e>o?(i.style.width=a/e+"px",i.style.height=a+"px"):(i.style.width=t+"px",i.style.height=t*e+"px"),s.cmManager.setBounds()}};y[t]("loadedmetadata",dt),dt()}return shield.init(s),J(".shield-enrty").addEventListener("click",shield.show),J(".shield_top .close").addEventListener("click",shield.show),J(".shield_item .add").addEventListener("click",shield.add),s}}}}}}}}}}}}}}}}}}}}}}}}}}}(),function(e){var t=function(){var t='<div class="colpick"><div class="colpick_color"><div class="colpick_color_overlay1"><div class="colpick_color_overlay2"><div class="colpick_selector_outer"><div class="colpick_selector_inner"></div></div></div></div></div><div class="colpick_hue"><div class="colpick_hue_arrs"><div class="colpick_hue_larr"></div><div class="colpick_hue_rarr"></div></div></div><div class="colpick_new_color"></div><div class="colpick_current_color"></div><div class="colpick_hex_field"><div class="colpick_field_letter">#</div><input type="text" maxlength="6" size="6" /></div><div class="colpick_rgb_r colpick_field"><div class="colpick_field_letter">R</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_g colpick_field"><div class="colpick_field_letter">G</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_h colpick_field"><div class="colpick_field_letter">H</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_s colpick_field"><div class="colpick_field_letter">S</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_submit"></div></div>',i={showEvent:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},colorScheme:"light",color:"3289c7",livePreview:!0,flat:!1,layout:"full",submit:1,submitText:"OK",height:156},l=function(t,i){var a=n(t);e(i).data("colpick").fields.eq(1).val(a.r).end().eq(2).val(a.g).end().eq(3).val(a.b).end()},r=function(t,i){e(i).data("colpick").fields.eq(4).val(Math.round(t.h)).end().eq(5).val(Math.round(t.s)).end().eq(6).val(Math.round(t.b)).end()},c=function(t,i){e(i).data("colpick").fields.eq(0).val(s(t))},d=function(t,i){e(i).data("colpick").selector.css("backgroundColor","#"+s({h:t.h,s:100,b:100})),e(i).data("colpick").selectorIndic.css({left:parseInt(e(i).data("colpick").height*t.s/100,10),top:parseInt(e(i).data("colpick").height*(100-t.b)/100,10)})},m=function(t,i){e(i).data("colpick").hue.css("top",parseInt(e(i).data("colpick").height-e(i).data("colpick").height*t.h/360,10))},u=function(t,i){e(i).data("colpick").currentColor.css("backgroundColor","#"+s(t))},p=function(t,i){e(i).data("colpick").newColor.css("backgroundColor","#"+s(t))},v=function(){var t,i=e(this).parent().parent();this.parentNode.className.indexOf("_hex")>0?(i.data("colpick").color=t=a(H(this.value)),l(t,i.get(0)),r(t,i.get(0))):this.parentNode.className.indexOf("_hsb")>0?(i.data("colpick").color=t=M({h:parseInt(i.data("colpick").fields.eq(4).val(),10),s:parseInt(i.data("colpick").fields.eq(5).val(),10),b:parseInt(i.data("colpick").fields.eq(6).val(),10)}),l(t,i.get(0)),c(t,i.get(0))):(i.data("colpick").color=t=o(_({r:parseInt(i.data("colpick").fields.eq(1).val(),10),g:parseInt(i.data("colpick").fields.eq(2).val(),10),b:parseInt(i.data("colpick").fields.eq(3).val(),10)})),c(t,i.get(0)),r(t,i.get(0))),d(t,i.get(0)),m(t,i.get(0)),p(t,i.get(0)),i.data("colpick").onChange.apply(i.parent(),[t,s(t),n(t),i.data("colpick").el,0])},f=function(){e(this).parent().removeClass("colpick_focus")},g=function(){e(this).parent().parent().data("colpick").fields.parent().removeClass("colpick_focus"),e(this).parent().addClass("colpick_focus")},h=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1;var i=e(this).parent().find("input").focus(),a={el:e(this).parent().addClass("colpick_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:t.pageY,field:i,val:parseInt(i.val(),10),preview:e(this).parent().parent().data("colpick").livePreview};e(document).mouseup(a,y),e(document).mousemove(a,b)},b=function(e){return e.data.field.val(Math.max(0,Math.min(e.data.max,parseInt(e.data.val-e.pageY+e.data.y,10)))),e.data.preview&&v.apply(e.data.field.get(0),[!0]),!1},y=function(t){return v.apply(t.data.field.get(0),[!0]),t.data.el.removeClass("colpick_slider").find("input").focus(),e(document).off("mouseup",y),e(document).off("mousemove",b),!1},S=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1;var i={cal:e(this).parent(),y:e(this).offset().top};e(document).on("mouseup touchend",i,B),e(document).on("mousemove touchmove",i,k);var a="touchstart"==t.type?t.originalEvent.changedTouches[0].pageY:t.pageY;return v.apply(i.cal.data("colpick").fields.eq(4).val(parseInt(360*(i.cal.data("colpick").height-(a-i.y))/i.cal.data("colpick").height,10)).get(0),[i.cal.data("colpick").livePreview]),!1},k=function(e){var t="touchmove"==e.type?e.originalEvent.changedTouches[0].pageY:e.pageY;return v.apply(e.data.cal.data("colpick").fields.eq(4).val(parseInt(360*(e.data.cal.data("colpick").height-Math.max(0,Math.min(e.data.cal.data("colpick").height,t-e.data.y)))/e.data.cal.data("colpick").height,10)).get(0),[e.data.preview]),!1},B=function(t){return l(t.data.cal.data("colpick").color,t.data.cal.get(0)),c(t.data.cal.data("colpick").color,t.data.cal.get(0)),e(document).off("mouseup touchend",B),e(document).off("mousemove touchmove",k),!1},P=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1;var i={cal:e(this).parent(),pos:e(this).offset()};i.preview=i.cal.data("colpick").livePreview,e(document).on("mouseup touchend",i,A),e(document).on("mousemove touchmove",i,C);var a,o;return"touchstart"==t.type?(a=t.originalEvent.changedTouches[0].pageX,
o=t.originalEvent.changedTouches[0].pageY):(a=t.pageX,o=t.pageY),v.apply(i.cal.data("colpick").fields.eq(6).val(parseInt(100*(i.cal.data("colpick").height-(o-i.pos.top))/i.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*(a-i.pos.left)/i.cal.data("colpick").height,10)).get(0),[i.preview]),!1},C=function(e){var t,i;return"touchmove"==e.type?(t=e.originalEvent.changedTouches[0].pageX,i=e.originalEvent.changedTouches[0].pageY):(t=e.pageX,i=e.pageY),v.apply(e.data.cal.data("colpick").fields.eq(6).val(parseInt(100*(e.data.cal.data("colpick").height-Math.max(0,Math.min(e.data.cal.data("colpick").height,i-e.data.pos.top)))/e.data.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(e.data.cal.data("colpick").height,t-e.data.pos.left))/e.data.cal.data("colpick").height,10)).get(0),[e.data.preview]),!1},A=function(t){return l(t.data.cal.data("colpick").color,t.data.cal.get(0)),c(t.data.cal.data("colpick").color,t.data.cal.get(0)),e(document).off("mouseup touchend",A),e(document).off("mousemove touchmove",C),!1},N=function(){var t=e(this).parent(),i=t.data("colpick").color;t.data("colpick").origColor=i,u(i,t.get(0)),t.data("colpick").onSubmit(i,s(i),n(i),t.data("colpick").el)},x=function(t){t.stopPropagation();var i=e("#"+e(this).data("colpickId"));i.data("colpick").onBeforeShow.apply(this,[i.get(0)]);var a=e(this).offset(),o=a.top+this.offsetHeight,n=a.left,l=T(),s=i.width();n+s>l.l+l.w&&(n-=s),i.css({left:n+"px",top:o+"px"}),0!=i.data("colpick").onShow.apply(this,[i.get(0)])&&i.show(),e("html").mousedown({cal:i},w),i.mousedown(function(e){e.stopPropagation()})},w=function(t){0!=t.data.cal.data("colpick").onHide.apply(this,[t.data.cal.get(0)])&&t.data.cal.hide(),e("html").off("mousedown",w)},T=function(){var e="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(e?document.documentElement.scrollLeft:document.body.scrollLeft),w:window.innerWidth||(e?document.documentElement.clientWidth:document.body.clientWidth)}},M=function(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b))}},_=function(e){return{r:Math.min(255,Math.max(0,e.r)),g:Math.min(255,Math.max(0,e.g)),b:Math.min(255,Math.max(0,e.b))}},H=function(e){var t=6-e.length;if(t>0){for(var i=[],a=0;t>a;a++)i.push("0");i.push(e),e=i.join("")}return e},F=function(){var t=e(this).parent(),i=t.data("colpick").origColor;t.data("colpick").color=i,l(i,t.get(0)),c(i,t.get(0)),r(i,t.get(0)),d(i,t.get(0)),m(i,t.get(0)),p(i,t.get(0))};return{init:function(n){if(n=e.extend({},i,n||{}),"string"==typeof n.color)n.color=a(n.color);else if(void 0!=n.color.r&&void 0!=n.color.g&&void 0!=n.color.b)n.color=o(n.color);else{if(void 0==n.color.h||void 0==n.color.s||void 0==n.color.b)return this;n.color=M(n.color)}return this.each(function(){if(!e(this).data("colpickId")){var i=e.extend({},n);i.origColor=n.color;var a="collorpicker_"+parseInt(1e3*Math.random());e(this).data("colpickId",a);var o=e(t).attr("id",a);o.addClass("colpick_"+i.layout+(i.submit?"":" colpick_"+i.layout+"_ns")),"light"!=i.colorScheme&&o.addClass("colpick_"+i.colorScheme),o.find("div.colpick_submit").html(i.submitText).click(N),i.fields=o.find("input").change(v).blur(f).focus(g),o.find("div.colpick_field_arrs").mousedown(h).end().find("div.colpick_current_color").click(F),i.selector=o.find("div.colpick_color").on("mousedown touchstart",P),i.selectorIndic=i.selector.find("div.colpick_selector_outer"),i.el=this,i.hue=o.find("div.colpick_hue_arrs"),huebar=i.hue.parent();var s=navigator.userAgent.toLowerCase(),b="Microsoft Internet Explorer"===navigator.appName,y=b?parseFloat(s.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0,k=b&&10>y,B=["#ff0000","#ff0080","#ff00ff","#8000ff","#0000ff","#0080ff","#00ffff","#00ff80","#00ff00","#80ff00","#ffff00","#ff8000","#ff0000"];if(k){var C,A;for(C=0;11>=C;C++)A=e("<div></div>").attr("style","height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="+B[C]+", endColorstr="+B[C+1]+'); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='+B[C]+", endColorstr="+B[C+1]+')";'),huebar.append(A)}else stopList=B.join(","),huebar.attr("style","background:-webkit-linear-gradient(top,"+stopList+"); background: -o-linear-gradient(top,"+stopList+"); background: -ms-linear-gradient(top,"+stopList+"); background:-moz-linear-gradient(top,"+stopList+"); -webkit-linear-gradient(top,"+stopList+"); background:linear-gradient(to bottom,"+stopList+"); ");o.find("div.colpick_hue").on("mousedown touchstart",S),i.newColor=o.find("div.colpick_new_color"),i.currentColor=o.find("div.colpick_current_color"),o.data("colpick",i),l(i.color,o.get(0)),r(i.color,o.get(0)),c(i.color,o.get(0)),m(i.color,o.get(0)),d(i.color,o.get(0)),u(i.color,o.get(0)),p(i.color,o.get(0)),i.flat?(o.appendTo(this).show(),o.css({position:"relative",display:"block"})):(o.appendTo(document.body),e(this).on(i.showEvent,x),o.css({position:"absolute"}))}})},showPicker:function(){return this.each(function(){e(this).data("colpickId")&&x.apply(this)})},hidePicker:function(){return this.each(function(){e(this).data("colpickId")&&e("#"+e(this).data("colpickId")).hide()})},setColor:function(t,i){if(i="undefined"==typeof i?1:i,"string"==typeof t)t=a(t);else if(void 0!=t.r&&void 0!=t.g&&void 0!=t.b)t=o(t);else{if(void 0==t.h||void 0==t.s||void 0==t.b)return this;t=M(t)}return this.each(function(){if(e(this).data("colpickId")){var a=e("#"+e(this).data("colpickId"));a.data("colpick").color=t,a.data("colpick").origColor=t,l(t,a.get(0)),r(t,a.get(0)),c(t,a.get(0)),m(t,a.get(0)),d(t,a.get(0)),p(t,a.get(0)),a.data("colpick").onChange.apply(a.parent(),[t,s(t),n(t),a.data("colpick").el,1]),i&&u(t,a.get(0))}})}}}(),i=function(e){var e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16);return{r:e>>16,g:(65280&e)>>8,b:255&e}},a=function(e){return o(i(e))},o=function(e){var t={h:0,s:0,b:0},i=Math.min(e.r,e.g,e.b),a=Math.max(e.r,e.g,e.b),o=a-i;return t.b=a,t.s=0!=a?255*o/a:0,t.h=0!=t.s?e.r==a?(e.g-e.b)/o:e.g==a?2+(e.b-e.r)/o:4+(e.r-e.g)/o:-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t},n=function(e){var t={},i=e.h,a=255*e.s/100,o=255*e.b/100;if(0==a)t.r=t.g=t.b=o;else{var n=o,l=(255-a)*o/255,s=(n-l)*(i%60)/60;360==i&&(i=0),60>i?(t.r=n,t.b=l,t.g=l+s):120>i?(t.g=n,t.b=l,t.r=n-s):180>i?(t.g=n,t.r=l,t.b=l+s):240>i?(t.b=n,t.r=l,t.g=n-s):300>i?(t.b=n,t.g=l,t.r=l+s):360>i?(t.r=n,t.g=l,t.b=n-s):(t.r=0,t.g=0,t.b=0)}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}},l=function(t){var i=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return e.each(i,function(e,t){1==t.length&&(i[e]="0"+t)}),i.join("")},s=function(e){return l(n(e))};e.fn.extend({colpick:t.init,colpickHide:t.hidePicker,colpickShow:t.showPicker,colpickSetColor:t.setColor}),e.extend({colpick:{rgbToHex:l,rgbToHsb:o,hsbToHex:s,hsbToRgb:n,hexToHsb:a,hexToRgb:i}})}(jQuery);